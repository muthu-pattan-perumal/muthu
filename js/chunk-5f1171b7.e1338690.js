(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5f1171b7"],{"91e6":function(e,t,i){},b02f:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("div",{staticClass:"header"},[t("div",[t("div",{staticClass:"row"},[e._m(0),t("ThemeSwitcher",{staticClass:"q-ml-sm theme-switch",attrs:{"no-border":!1}})],1),t("div",{staticClass:"content"},[t("div",{staticClass:"upload-section"},[t("div",{staticClass:"upload-content"},[t("h6",[e._v("Here Field name")]),t("p"),t("div",{staticClass:"file-upload"},[t("input",{attrs:{id:"file-input",type:"file",hidden:""},on:{change:e.handleFileUpload}}),t("label",{staticClass:"file-label",attrs:{for:"file-input"}},[t("div",{staticClass:"file-icon"},[t("BaseIcon",{staticClass:"icon",attrs:{name:"eva-cloud-upload-outline",size:"20px",color:"primary"}})],1),t("p",[e._v("Select file")])])]),e._m(1),t("div",{staticClass:"file-upload"},[t("input",{attrs:{id:"camera-input",type:"file",accept:"image/*",capture:"environment",hidden:""},on:{change:e.handleFileUpload}}),t("label",{staticClass:"file-label",attrs:{for:"camera-input"}},[t("div",{staticClass:"file-icon"},[t("BaseIcon",{staticClass:"icon",attrs:{name:"mdi-camera",size:"20px",color:"primary"}})],1),t("p",[e._v("Capture image")])])]),e.filePreview?t("div",{staticClass:"file-preview"},[e.isImage?t("img",{staticClass:"preview-image",attrs:{src:e.filePreview}}):t("p",[e._v(e._s(e.fileName))])]):e._e(),e.isUploading?t("div",{staticClass:"loading-bar"},[t("q-circular-progress",{staticClass:"q-mr-sm",attrs:{"show-value":"","font-size":"12px",value:e.uploadProgress,size:"lg",thickness:.22,color:"primary","track-color":"grey-3"}},[e._v(" "+e._s(e.uploadProgress)+"% ")])],1):e._e()])]),t("button",{staticClass:"continue-button",on:{click:e.uploadFile}},[e._v("Submit")])])])]),t("ImageCropper",{attrs:{image:e.originalImage},on:{save:e.saveImage},model:{value:e.isImageCropperVisible,callback:function(t){e.isImageCropperVisible=t},expression:"isImageCropperVisible"}})],1)},a=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"col text-center"},[t("div",{staticClass:"title-1"},[e._v("Upload file")]),t("div",{staticClass:"description"},[e._v(" Selected files have been uploaded to the scanned directory. ")])])},function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"or-section"},[t("span",[e._v("(or)")])])])}],o=(i("14d9"),i("fd26")),r=i("1b0d"),l=i("bc3a"),n=i.n(l),d=i("dd90"),c=i("054c"),p={name:"MobileUpload",components:{ThemeSwitcher:o["a"],ImageCropper:c["a"]},props:{tenantId:{type:String,required:!0},userId:{type:String,required:!0},uniqueId:{type:String,required:!0}},data(){return{file:null,filePreview:null,isImage:!1,fileName:"",isUploading:!1,uploadProgress:0,attachmentList:[],imageSrc:"",isImageCropperVisible:!1,repositoryId:0,url:"",upload:!1,fieldId:"",originalImage:""}},watch:{userId:{immediate:!0,handler:"getSession"}},methods:{saveImage(e){this.imageSrc=e,this.isImageCropperVisible=!1},async getSession(){console.log(this.tenantId,this.userId,this.uniqueId);const{error:e}=await r["a"].externalLogin(this.tenantId,this.userId);e?this.$alert.info("User Account Not Found"):this.getProcess()},async getProcess(){console.log("called");const{error:e,payload:t}=await r["p"].getQrFileUploadById(this.uniqueId);if(console.log(e,t,"error, payload"),e)return this.upload=!0,void this.$alert.info("form details Not Found");if(t.status)return this.upload=!0,void this.$alert.info("file already uploaded");let i=JSON.parse(t.jsonData);console.log(i,"jsonData"),this.repositoryId=i[0].repositoryId,this.fieldId=i[0].fieldId,this.url=i[0].url},handleFileUpload(e){this.originalImage="";const t=e.target.files[0];if(t)if(this.file=t,this.fileName=t.name,this.isImage=t.type.startsWith("image/"),console.log(t,"file"),this.isImage){const e=new FileReader;e.onload=e=>{this.filePreview=e.target.result},console.log(this.filePreview,"this.filePreview"),e.readAsDataURL(t),this.originalImage=this.filePreview,this.imageSrc=this.filePreview,this.isImageCropperVisible=!0}else this.filePreview=!0},async uploadFile(){if(!this.file)return;if(this.upload)return void this.$alert.info("file already uploaded");this.isUploading=!0,this.uploadProgress=0;const e=this.file;let t=this.file.name;console.log(e);const i=new FormData;i.append("file",e),i.append("repositoryId",this.repositoryId),t&&i.append("filename",this.file.name);let s=this.file.name;const a=s.split(".").pop();if(!Object(d["a"])(a))return void this.$alert.info("This file format is not supported");console.log(i,"formData"),this.$store.commit("showLoadingBar");try{const t=await n()({url:"https://appuat.ezofis.com/ezofisapi/api/uploadAndIndex/upload",method:"POST",data:i,headers:{Token:this.$store.state.identity.token,Accept:"application/json","Content-Type":"multipart/form-data"}});this.$store.commit("hideLoadingBar"),console.log(t,"response");const{status:a,data:o}=t;if(200!==a)throw"Invalid response";let r=JSON.parse(o);this.attachmentList.push({id:Number(r.fileId),name:s,createdAt:(new Date).toISOString(),createdByEmail:this.$store.state.session.email,size:e.size,initiate:!0,uid:this.rowIndex}),console.log(this.attachmentList,"this.attachmentList"),await this.updateJson()}catch(r){console.error(r),this.$alert.error("error attaching file")}const o=setInterval(()=>{this.uploadProgress<100?this.uploadProgress+=10:(clearInterval(o),this.isUploading=!1)},500)},async updateJson(){console.log(this.repositoryId,this.url,this.attachmentList);let e={id:this.uniqueId,url:this.url,jsonData:JSON.stringify([{repositoryId:this.repositoryId,fieldId:this.fieldId,attachmentList:this.attachmentList}]),status:1};const{error:t,payload:i}=await r["p"].updateJson(this.uniqueId,e);console.log(t,i,"error, payload"),this.$alert.success("file uploaded successfully!")}}},u=p,h=(i("b529"),i("2877")),m=i("58ea"),f=i("93dc"),g=i.n(f),v=Object(h["a"])(u,s,a,!1,null,"0660a973",null);t["default"]=v.exports;g()(v,"components",{QCircularProgress:m["a"]})},b529:function(e,t,i){"use strict";i("91e6")},fd26:function(e,t,i){"use strict";var s=function(){var e=this,t=e._self._c;return t("BaseActionButton",{attrs:{"is-flat":"","no-border":e.noBorder,icon:e.darkTheme?"eva-moon-outline":"eva-sun-outline"},on:{click:e.toggleDarkTheme}})},a=[],o=i("2f62"),r={name:"ThemeSwitcher",props:{noBorder:{type:Boolean,default:!0}},computed:{...Object(o["c"])(["darkTheme"])},methods:{...Object(o["b"])(["toggleDarkTheme"])}},l=r,n=i("2877"),d=Object(n["a"])(l,s,a,!1,null,"b3ced1f0",null);t["a"]=d.exports}}]);
//# sourceMappingURL=chunk-5f1171b7.e1338690.js.map