(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["external-request"],{"062e":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{style:{width:e.formWidth},attrs:{id:"external-request"}},[e.loadingBarContent?t("BaseLoadingBarSheet",{staticClass:"loading-content"}):e._e(),t("div",{staticClass:"header col"},[t("div",{staticClass:"col text-center"},[t("div",{staticClass:"title-1"},[e._v(e._s(e.title))]),t("div",{staticClass:"description"},[e._v(e._s(e.description))])]),"FORM"===e.workflow.initiatedBy&&Object.keys(e.selectedProcess).length?[e.mandatory.filledValue||e.mandatory.nonFilledValue?[t("q-circular-progress",{staticClass:"q-mr-sm",attrs:{"show-value":"","font-size":"12px",value:e.mandatoryFilling,size:"lg",thickness:.22,color:"primary","track-color":"grey-3"}},[e._v(" "+e._s(e.mandatoryFilling)+"% ")])]:e._e(),e.mandatory.filledValue?t("div",{staticClass:"chip-success q-mr-sm"},[t("div",{},[e._v(e._s(e.mandatory.filledValue)+" ready")])]):e._e(),e.mandatory.nonFilledValue?t("div",{staticClass:"chip-warning",on:{click:e.checkFormValidation}},[t("div",{},[e._v(e._s(e.mandatory.nonFilledValue)+" need to work")])]):e._e(),e.mandatoryDocument.length?[t("div",{staticClass:"chip-warning cursor-pointer",on:{click:function(t){e.attachmentSheet=!0}}},[t("div",{},[e._v(e._s(e.mandatoryDocument.length)+" document required")])])]:e._e(),e.formView?e._e():t("BaseActionButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:"Change View",expression:"'Change View'",modifiers:{top:!0}}],staticClass:"q-mr-xs",attrs:{"is-flat":"",icon:"mdi-form-select"},on:{click:function(t){e.formView=!0}}}),e.formView?t("BaseActionButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:"Change View",expression:"'Change View'",modifiers:{top:!0}}],staticClass:"q-mr-xs",attrs:{"is-flat":"",icon:"mdi-table-column"},on:{click:function(t){e.formView=!1}}}):e._e(),t("ThemeSwitcher",{staticClass:"q-ml-sm",attrs:{"no-border":!1}})]:e._e()],2),!e.loadingBarContent&&Object.keys(e.selectedProcess).length?[t("div",{staticClass:"content",attrs:{id:"content-wrapper"}},[t("div",{staticClass:"row"},[e.formView||"DOCUMENT_SIGN"===e.workflow.initiatedBy?[e.formId?t("div",{staticClass:"col",attrs:{id:"form-view"}},[t("BaseScrollbar",{attrs:{height:e.processActions.length?"calc(100vh - 210px)":"calc(100vh - 155px)"}},[t("RenderForm",{attrs:{"form-id":e.formId,panels:e.panels,"secondary-panels":e.secondaryPanels,"form-settings":e.formSettings,"form-model":e.formModel,"workflow-actions":[],"save-action":e.saveAction,"workflow-form-model":e.workflowFormModel,"workflow-model":e.workflowModel,"is-readonly":e.formEditAccess,"form-edit-controls":e.formEditControls,"readonly-controls":e.readonlyControls,"form-visibility-access":e.formVisibilityAccess,"form-secure-controls":e.formSecureControls,"enable-controls":e._enableControls,"form-upload-files":e.formUploadFiles,"has-check-form-validate":e.hasCheckFormValidate,"ocr-result":e.ocrResult},on:{"update:saveAction":function(t){e.saveAction=t},"update:save-action":function(t){e.saveAction=t},"update:workflowFormModel":function(t){e.workflowFormModel=t},"update:workflow-form-model":function(t){e.workflowFormModel=t},"update:workflowModel":function(t){e.workflowModel=t},"update:workflow-model":function(t){e.workflowModel=t},"update:hasCheckFormValidate":function(t){e.hasCheckFormValidate=t},"update:has-check-form-validate":function(t){e.hasCheckFormValidate=t},uploadFiles:e.getOCRResult,mandatoryControlsList:e.mandatoryControlsList,deletedFiles:e.deletedFiles}})],1)],1):e.selectedProcess.itemData.itemId?t("div",{staticClass:"col-12 q-pa-xs",attrs:{id:"document-view"}},[t("iframe",{ref:"myProcessFiles",staticStyle:{width:"100%",height:"78vh"},attrs:{id:"file-frame",src:e.itemLink(),frameborder:"0"}})]):e._e()]:[t("div",{key:e.selectedProcess.processId+"det",staticClass:"col"},[t("BaseScrollbar",{attrs:{height:e.processActions.length?"calc(100vh - 210px)":"calc(100vh - 155px)"}},[t("div",{staticClass:"col"},[t("div",{staticClass:"col-12",attrs:{id:"requestDetails"}},[t("div",{staticClass:"row justify-center"},[t("div",{staticClass:"col q-pa-md"},[t("div",{staticClass:"row items-center"},[t("table",{staticClass:"submittedData q-mb-sm"},[t("tbody",[e.selectedProcess.createdByName?t("tr",[t("td",{attrs:{colspan:"4"}},[e._v(" Requested By: "+e._s(e.selectedProcess.createdByName)+" ")])]):e._e(),t("tr",[e.selectedProcess.raisedBy?t("th",[e._v(" Requested User Email ")]):e._e(),t("th",[e._v("Requested Date")]),t("th",[e._v("Last Acted By")]),t("th",[e._v("Last Acted On")])]),t("tr",[e.selectedProcess.raisedBy?t("td",[e._v(" "+e._s(e.selectedProcess.raisedBy)+" ")]):e._e(),t("td",[e._v(" "+e._s(e.$day.format(e.selectedProcess.raisedAt))+" ")]),t("td",[e._v(" "+e._s(e.selectedProcess.transaction_createdByEmail)+" ")]),t("td",[e._v(" "+e._s(e.$day.format(e.selectedProcess.transaction_createdAt))+" ")])])])]),t("BaseScrollbar",{attrs:{height:e.processActions.length?"calc(100vh - 370px)":"calc(100vh - 315px)"}},[e.requestFormData.panels?[t("table",{staticClass:"mainData col-12"},[e._l(e.requestFormData.panels,(function(s){return[t("tr",{key:s.name,staticStyle:{cursor:"pointer"},on:{click:function(e){s.panelsExpandView=!s.panelsExpandView}}},[t("td",{staticStyle:{color:"#643094"},attrs:{colspan:"2"}},[s.panelsExpandView?t("BaseIcon",{staticClass:"icon",attrs:{name:"eva-arrow-downward-outline",size:"20px",color:"primary"}}):t("BaseIcon",{staticClass:"icon",attrs:{name:"eva-arrow-forward-outline",size:"20px",color:"primary"}}),e._v(" "+e._s(s.name||"No Title")+" ")],1)]),s.panelsExpandView?[e._l(s.fields,(function(s,i){return[s&&"[]"!=s?["TABLE"!==e.validateType(i)?[t("tr",{key:i},[t("td",{staticClass:"tblHeader ellipsis small"},[e._v(" "+e._s(e.getLabel(i))+" ")]),t("td",{staticClass:"ellipsis"},["FILE_UPLOAD"===e.validateType(i)?[JSON.parse(s).length?t("div",e._l(JSON.parse(s),(function(i){return t("div",{key:i.fileName,staticClass:"q-mb-xs"},[t("div",{staticClass:"row items-center"},[t("div",{staticClass:"col row items-center",on:{click:function(t){return e.viewFile(i,s)}}},[t("FileIcon",{staticClass:"mini-avatar q-mr-sm",attrs:{"mime-type":e.fileType(i.fileName)}}),t("span",{staticClass:"cursor-pointer text-underline text-secondary"},[e._v(e._s(i.fileName))])],1)])])})),0):e._e()]:"DATE"===e.validateType(i)?[e._v(" "+e._s(e.$day.format(s,!1))+" ")]:e.validateValue(s)?[e._v(" "+e._s(e.removeTags(s)||"-")+" ")]:[t("a",{attrs:{href:s,target:"_blank"}},[e._v(" "+e._s(s||"-")+" ")])]],2)])]:JSON.parse(s).length?[e.getLabel(i)?t("tr",{key:"trlabel"+i},[t("td",{staticClass:"ellipsis small text-primary",attrs:{colspan:"2"}},[e._v(" "+e._s(e.getLabel(i))+" ")])]):e._e(),t("tr",{key:"trtable"+i},[t("td",{attrs:{colspan:"2"}},[t("BaseScrollbar",{key:"scroll"+i,staticStyle:{"max-height":"200px"}},[t("table",{key:"table"+i,staticClass:"sub-table q-mt-sm q-mb-sm"},[t("thead",[t("tr",e._l(e.tableValue(s)[0],(function(s,i){return t("th",{key:i},[e._v(" "+e._s(e.getLabel(i,"table"))+" ")])})),0)]),t("tbody",e._l(e.tableValue(s),(function(s,i){return t("tr",{key:i},e._l(s,(function(s,i){return t("td",{key:i},[e._v(" "+e._s(s)+" ")])})),0)})),0)])])],1)])]:e._e()]:e._e()]}))]:e._e()]}))],2)]:e._e()],2)],1)])])])])])],1)],"DOCUMENT_SIGN"!==e.workflow.initiatedBy?t("div",{staticClass:"col-auto q-mr-sm leftBorder"},[e._l(e.tabs,(function(s){return[t("BaseActionButton",{directives:[{name:"tooltip",rawName:"v-tooltip.left",value:s.label,expression:"tab.label",modifiers:{left:!0}}],key:s.id,staticClass:"tabButtons",attrs:{"is-flat":"","no-border":"",icon:s.icon,color:"primary"},on:{click:function(t){return e.showLinks(s.value)}}},[s.count?t("span",{staticClass:"badge"},[e._v(e._s(s.count)+" ")]):e._e()])]}))],2):e._e()],2),"DOCUMENT_SIGN"!==e.workflow.initiatedBy&&e.processActions.length&&""===e.selectedProcess.review?t("div",{staticClass:"action-footer border-top q-pa-sm"},[t("BaseButton",{staticClass:"q-ml-md",attrs:{label:"Save",color:"secondary"},on:{click:function(t){e.saveAction="Save"}}}),e._l(e.processActions,(function(s){return["Approve"===s||"Complete"===s||"Rightsize"===s||s.indexOf("Approve")>-1?t("BaseButton",{key:s,staticClass:"q-ml-md",attrs:{label:s,color:"positive"},on:{click:function(t){e.saveAction=s}}}):"Reject"===s||"Terminate"===s||"Force Close"===s||"Decline"===s||s.indexOf("Reject")>-1?t("BaseButton",{key:s,staticClass:"q-ml-md",attrs:{label:s,color:"red"},on:{click:function(t){e.saveAction=s}}}):"Forward"===s||s.indexOf("Reply")>-1||"Rollback"===s||"Assign"===s?t("BaseButton",{key:s,staticClass:"q-ml-md",attrs:{label:s,color:"orange"},on:{click:function(t){e.saveAction=s}}}):t("BaseButton","To Requester"===s?{key:s,staticClass:"q-ml-md",attrs:{label:s,color:"pink"},on:{click:function(t){e.saveAction=s}}}:{key:s,staticClass:"q-ml-md",attrs:{label:s},on:{click:function(t){e.saveAction=s}}})]}))],2):e._e()])]:e.loadingBarContent?e._e():[t("StateWrapper",{attrs:{icon:"eva-archive-outline",title:"Process Request",description:"Request details not found"}})],e._m(0),t("Sheet",{attrs:{width:"30vw","sub-actions":e.checkListTemplate,"sub-actions-height":105,upload:!!e.processActions.length},on:{input:function(t){e.attachmentSheet=!1}},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" Attachments ")]},proxy:!0},{key:"actions",fn:function(){return[e.selectedProcess.processId?t("div",{staticClass:"q-ml-sm text-gray q-mr-sm ellipsis",staticStyle:{"font-size":"10px"}},[e._v(" auto-refresh every 15 seconds ")]):e._e(),t("BaseActionButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:"refresh",expression:"'refresh'",modifiers:{top:!0}}],staticClass:"q-mr-xs",attrs:{icon:"mdi-refresh",color:"secondary","no-border":"","is-flat":"",size:"20px"},on:{click:e.getAttachments}})]},proxy:!0},e.processActions.length?{key:"upload",fn:function(){return[t("div",{staticClass:"hint",on:{click:function(t){e.rowIndex=null,e.$refs.attachments.click()}}},[t("BaseIcon",{staticClass:"icon",attrs:{name:"eva-cloud-upload-outline",size:"32px",color:"blue"}}),t("div",{staticClass:"title text-blue"},[e._v("UPLOAD FILES")]),t("div",{staticClass:"description"},[e._v("Click here to choose files and upload")])],1)]},proxy:!0}:null,{key:"subActions",fn:function(){return[t("div",{staticClass:"q-mt-sm"},[t("div",{staticClass:"row q-mb-sm"},[t("div",{staticClass:"q-mt-xs"},[e._v("Checklist Documents")]),t("q-space"),t("div",{on:{click:e.downloadAll}},[t("q-chip",{staticClass:"chips grey-hover large",attrs:{outline:"",color:"grey"}},[e._v(" Download All ")])],1)],1),t("div",{staticClass:"row q-mb-md description text-sm text-grey"},[e._v(" It can be useful to ensure that all necessary information and supporting documents are included ")])])]},proxy:!0}],null,!0),model:{value:e.attachmentSheet,callback:function(t){e.attachmentSheet=t},expression:"attachmentSheet"}},[t("div",{attrs:{id:"content-wrapper"}},[t("BaseScrollbar",{attrs:{height:e.processActions.length?"calc(100vh - 210px)":"calc(100vh - 150px)"}},[t("input",{ref:"attachments",staticClass:"hidden",attrs:{type:"file"},on:{change:e.uploadWflowAttachments}}),e._l(e.checkList,(function(s){return[s.name?[s.attach?e._e():t("div",{key:s.uid,staticClass:"checkList"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-auto"},[t("BaseIcon",{attrs:{name:"mdi-file-check-outline",color:"primary"}})],1),t("div",{staticClass:"col q-ml-sm"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12"},[e._v(" "+e._s(s.name)+" ")]),s.required?t("div",{staticClass:"col-12 q-mt-sm"},[t("q-chip",{staticClass:"chips small",attrs:{outline:"",color:"red"}},[e._v(" Required ")])],1):e._e()])]),t("div",{staticClass:"col-auto"},[t("div",{staticClass:"col-12",on:{click:function(t){return e.attachTemplate(s.uid)}}},[t("q-chip",{staticClass:"chips primary-hover medium",attrs:{outline:"",color:"primary"}},[t("q-avatar",{staticClass:"q-mr-sm",attrs:{icon:"eva-upload-outline",color:"primary","text-color":"white"}}),e._v(" Upload ")],1)],1),s.template?t("div",{staticClass:"col-12",on:{click:function(t){return e.download(s.id)}}},[t("q-chip",{staticClass:"chips secondary-hover medium",attrs:{outline:"",color:"secondary"}},[t("q-avatar",{staticClass:"q-mr-sm",attrs:{icon:"eva-download-outline",color:"secondary","text-color":"white"}}),e._v(" Download ")],1)],1):e._e()])])])]:e._e()]})),e._l(e.attachmentList,(function(s){return[t("div",{key:s.id,staticClass:"attachmentList"},[t("div",{staticClass:"title row cursor-pointer"},[e.selectedProcess.processId?t("div",{staticClass:"col-auto"},[t("BaseIcon",{staticClass:"q-mr-sm",attrs:{name:s.checked?"eva-checkmark-circle-2":"eva-radio-button-off-outline",color:"secondary"},on:{click:function(e){s.checked=!s.checked}}})],1):e._e(),t("div",{staticClass:"col-auto"},[t("FileIcon",{staticClass:"mini-avatar q-mr-sm",attrs:{"mime-type":e.fileType(s.name)}})],1),t("div",{staticClass:"col ellipsis",on:{click:function(t){return e.openFile(s)}}},[e._v(" "+e._s(s.name)+" ")]),t("div",{staticClass:"col-auto"},[t("BaseActionButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:"Download",expression:"'Download'",modifiers:{top:!0}}],attrs:{icon:"eva-download-outline",color:"primary","no-border":"","is-flat":"",size:"20px"},on:{click:function(t){return t.stopPropagation(),e.fileMenuAction(s,"Download")}}})],1),t("div",{staticClass:"col-auto"},[t("BaseActionButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:"delete",expression:"'delete'",modifiers:{top:!0}}],attrs:{icon:"eva-trash-2-outline",color:"red","no-border":"","is-flat":"",size:"20px"},on:{click:function(t){return t.stopPropagation(),e.attachmentDelete(s)}}})],1)]),s.formJsonId?t("div",{staticClass:"row q-mb-sm"},[t("div",{staticClass:"col-auto ellipsis attachment-label"},[e._v(" "+e._s(e.getLabel(s.formJsonId))+" ")])]):e._e(),t("div",{staticClass:"meta row"},[t("div",[e._v(e._s(e.$day.format(s.createdAt)))]),s.createdBy?[t("BaseIcon",{attrs:{name:"mdi-circle-small"}}),t("div",[e._v(e._s(s.createdByEmail))])]:e._e()],2)])]}))],2),t("div",{staticClass:"q-mt-xs defaultBottom"},[t("BaseIcon",{attrs:{name:"mdi-circle-medium",color:"red"}}),e._v(" Required Documents ")],1)],1)]),t("Sheet",{attrs:{width:"30vw",height:"80vh","custom-height":"30"},on:{input:function(t){e.closeCommnetsSheet=!1}},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" Comments ")]},proxy:!0},{key:"actions",fn:function(){return[e.selectedProcess.processId?t("div",{staticClass:"q-ml-sm text-gray q-mr-sm ellipsis",staticStyle:{"font-size":"10px"}},[e._v(" auto-refresh every 30 seconds ")]):e._e(),t("BaseActionButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:"refresh",expression:"'refresh'",modifiers:{top:!0}}],staticClass:"q-mr-sm",attrs:{icon:"mdi-refresh",color:"secondary","no-border":"","is-flat":"",size:"20px"},on:{click:function(t){return e.getComments()}}})]},proxy:!0}]),model:{value:e.commentsSheet,callback:function(t){e.commentsSheet=t},expression:"commentsSheet"}},[t("div",{attrs:{id:"content-wrapper"}},[t("BaseScrollbar",{attrs:{height:e.processActions.length?"calc(100vh - 155px)":"calc(100vh - 60px)"}},[e._l(e.commentsList,(function(s,i){return[t("q-chat-message",{key:i,staticClass:"q-ma-sm",attrs:{name:s.createdBy===e.$store.state.session.id?"me":s.createdByEmail,text:[s.comments],"text-html":"",sent:s.createdBy===e.$store.state.session.id,stamp:e.lastCommentDuration(s),"bg-color":s.createdBy===e.$store.state.session.id?"primary-1":"secondary-2"}})]}))],2)],1),e.processActions.length?t("div",{staticClass:"col q-pa-sm borderTop"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col"},[t("TextAreaField",{attrs:{"auto-focus":"",placeholder:"Type a new comment..."},model:{value:e.commentText,callback:function(t){e.commentText=t},expression:"commentText"}})],1),t("div",{staticClass:"col-auto",staticStyle:{margin:"auto"}},[t("BaseActionButton",{directives:[{name:"tooltip",rawName:"v-tooltip.left",value:"Post Comments",expression:"'Post Comments'",modifiers:{left:!0}}],staticClass:"q-ml-sm commentAction",attrs:{icon:"eva-paper-plane-outline",color:"primary-11",size:"16px","rotate-class":"rotate-45"},on:{click:e.saveComment}}),t("BaseActionButton",{directives:[{name:"tooltip",rawName:"v-tooltip.left",value:"Advanced Comments",expression:"'Advanced Comments'",modifiers:{left:!0}}],staticClass:"q-ml-sm q-mt-sm commentAction",attrs:{icon:"mdi-comment-text-multiple",color:"primary-11",size:"16px"},on:{click:function(t){e.advancedCommentsSheet=!0}}})],1)])]):e._e()]),t("Sheet",{attrs:{"no-padding":"",width:"100vw"},on:{input:function(t){e.fileSheet=!1}},scopedSlots:e._u([{key:"title",fn:function(){return[t("div",{staticClass:"attachmentFileHeader"},[e.selectedFile.formJsonId?[t("BaseActionButton",{directives:[{name:"tooltip",rawName:"v-tooltip:green.bottom",value:e.getLabel(e.selectedFile.formJsonId),expression:"getLabel(selectedFile.formJsonId)",arg:"green",modifiers:{bottom:!0}}],staticClass:"q-mr-sm",attrs:{"is-flat":"",icon:"mdi-form-select",color:"primary"}})]:e._e(),t("div",{staticClass:"avatar q-ml-sm"},[t("FileIcon",{attrs:{"mime-type":e.fileType(e.selectedFile.name)}})],1),t("div",{staticClass:"q-ml-md"},[t("div",{staticClass:"filename"},[e._v(" "+e._s(e.selectedFile.name)+" ")]),t("div",{staticClass:"meta"},[e.selectedFile.createdAt?[t("div",[e._v(" Archived At: "+e._s(e.$day.format(e.selectedFile.createdAt))+" ")]),t("BaseIcon",{attrs:{name:"mdi-circle-small"}})]:e._e(),e.selectedFile.createdByEmail?[t("div",[e._v("Archived By: "+e._s(e.selectedFile.createdByEmail))])]:e._e(),e.selectedFile.size?t("div",[t("BaseIcon",{attrs:{name:"mdi-circle-small"}}),e._v(" File Size: "+e._s(e.fileSize(e.selectedFile.size))+" ")],1):e._e()],2)])],2)]},proxy:!0},{key:"actions",fn:function(){return[t("BaseActionButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:"Actions",expression:"'Actions'",modifiers:{top:!0}}],staticClass:"q-mr-sm",attrs:{"is-flat":"",icon:"eva-menu"}},[t("q-menu",{attrs:{"transition-show":"scale","transition-hide":"scale",anchor:"bottom end",self:"top right"}},[t("BaseScrollbar",{staticClass:"q-pb-sm",attrs:{width:"240px"}},e._l(e.documentActionList,(function(s){return t("ListItem",{key:s.id,attrs:{icon:s.icon,label:s.label},on:{click:function(t){return e.documentAction(s.id)}}})})),1)],1)],1)]},proxy:!0}]),model:{value:e.fileSheet,callback:function(t){e.fileSheet=t},expression:"fileSheet"}},[t("div",{staticClass:"attachmentFileFrame"},[t("div",{staticClass:"file-list"},[t("iframe",{ref:"myFiles",attrs:{id:"file-frame",src:e.fileLink(),frameborder:"0"}})])])]),t("Confirm",{attrs:{icon:"eva-checkmark-circle-2","icon-color":"green",size:"24px"},on:{input:e.closeSuccessModal},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("Action on Request!")]},proxy:!0},{key:"default",fn:function(){return[t("div",{staticClass:"q-py-md text-lg"},[t("p",[e._v("Thank you for taking action on the request")])])]},proxy:!0},{key:"footer",fn:function(){return[t("BaseButton",{attrs:{label:"Close",color:"primary"},on:{click:e.closeSuccessModal}})]},proxy:!0}]),model:{value:e.successModal,callback:function(t){e.successModal=t},expression:"successModal"}}),t("Confirm",{attrs:{icon:"mdi-file-alert","icon-color":"red"},on:{input:e.closeAlertModal},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("Documents Required!")]},proxy:!0},{key:"default",fn:function(){return[t("div",{staticClass:"q-py-md text-md"},[t("p",[e._v(" Are you sure you want to submit the request without attaching the required documents. ")]),t("p",{staticClass:"text-secondary"},[e._v(" After registration, you will get the link to track your request."),t("br"),e._v("From there, you can upload the required documents once you have them. ")])])]},proxy:!0},{key:"footer",fn:function(){return[t("BaseButton",{staticClass:"q-mr-sm",attrs:{"is-flat":"",label:"no"},on:{click:e.closeAlertModal}}),t("BaseButton",{attrs:{label:"yes",color:"primary"},on:{click:e.processRequest}})]},proxy:!0}]),model:{value:e.alertModal,callback:function(t){e.alertModal=t},expression:"alertModal"}}),t("Modal",{attrs:{width:"60vw",height:"80vh","has-footer":""},on:{input:function(t){e.advancedCommentsSheet=!1}},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" Comments")]},proxy:!0},{key:"default",fn:function(){return[t("TextBuilderField",{model:{value:e.advancedCommentText,callback:function(t){e.advancedCommentText=t},expression:"advancedCommentText"}})]},proxy:!0},{key:"footer",fn:function(){return[t("BaseButton",{attrs:{label:"Post",icon:"eva-paper-plane-outline",color:"primary"},on:{click:e.saveAdvancedComment}})]},proxy:!0}]),model:{value:e.advancedCommentsSheet,callback:function(t){e.advancedCommentsSheet=t},expression:"advancedCommentsSheet"}}),t("MetaDataEdit",{attrs:{value:e.showMetaDataEditModal,file:e.workflow,"repository-field":e.repositoryField,"file-data":e.fileData,title:"Index",columns:e._columns,"modal-value":e.workflowModel,"upload-filename":e.uploadFilename},on:{close:e.closeMetaDataEditModal,save:e.saveMetaData}}),e.historyProcessId?t("ProcessHistory",{attrs:{"process-id":e.historyProcessId,"selected-process":e.selectedProcess},on:{close:function(t){e.historyProcessId=0}}}):e._e(),t("Modal",{attrs:{width:"40vw",height:"50vh","has-footer":""},on:{input:function(t){e.saveAction="",e.processForwardModal=!1}},scopedSlots:e._u([{key:"title",fn:function(){return[e._v('"'+e._s(e.selectedProcess.requestNo)+'" '),[e._v(" Process Forward ")]]},proxy:!0},{key:"default",fn:function(){return[t("div",{attrs:{id:"processForward"}},[e.internalForward.proceed?t("MultiSelectField",{staticClass:"field",attrs:{label:"users","is-mandatory":"",options:e.internalForward.users.length?e.internalForward.users:e.userList},model:{value:e.forwardUsers,callback:function(t){e.forwardUsers=t},expression:"forwardUsers"}}):e._e(),e.internalForward.groups.length?t("MultiSelectField",{staticClass:"field",attrs:{label:"group",options:e.internalForward.groups.length?e.internalForward.groups:e.groupList},model:{value:e.forwardGroups,callback:function(t){e.forwardGroups=t},expression:"forwardGroups"}}):e._e()],1)]},proxy:!0},{key:"footer",fn:function(){return[t("BaseButton",{attrs:{label:"Forward",color:"orange"},on:{click:function(t){e.processForwardModal=!1,e.requestAction("Forward",!1,!1)}}})]},proxy:!0}]),model:{value:e.processForwardModal,callback:function(t){e.processForwardModal=t},expression:"processForwardModal"}}),t("Confirm",{attrs:{icon:"eva-alert-circle-outline","icon-color":"red"},on:{input:function(t){e.saveAction="",e.workflowFormModel="",e.actionPasswordConfirm=!1}},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" Action Password")]},proxy:!0},{key:"default",fn:function(){return[t("ValidationObserver",{ref:"passwordForm"},[t("ValidationProvider",{attrs:{name:"password",rules:{required:!0,password:!0}},scopedSlots:e._u([{key:"default",fn:function({errors:s}){return[t("PasswordField",{staticClass:"q-my-lg",attrs:{"is-mandatory":"","is-readonly":e.isLoading,error:s[0],"auto-focus":!0},on:{enter:e.validatePassword},model:{value:e.actionUserPassword,callback:function(t){e.actionUserPassword=t},expression:"actionUserPassword"}})]}}])})],1)]},proxy:!0},{key:"footer",fn:function(){return[t("BaseButton",{attrs:{label:"validate","is-loading":e.isLoading},on:{click:e.validatePassword}})]},proxy:!0}]),model:{value:e.actionPasswordConfirm,callback:function(t){e.actionPasswordConfirm=t},expression:"actionPasswordConfirm"}}),t("Confirm",{attrs:{icon:"eva-alert-circle-outline","icon-color":"red"},on:{input:function(t){e.actionConfirmAlert=!1}},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" Confirmation")]},proxy:!0},{key:"default",fn:function(){return[t("div",{staticClass:"q-py-md"},[t("p",[e._v(' Are you sure you want to confirm the action as " '),t("b",[e._v(e._s(e.saveAction))]),e._v('"? ')])])]},proxy:!0},{key:"footer",fn:function(){return[t("BaseButton",{staticClass:"q-mr-sm",attrs:{"is-flat":"",label:"no",color:"primary"},on:{click:function(t){e.saveAction="",e.workflowFormModel={},e.actionConfirmAlert=!1}}}),t("BaseButton",{attrs:{label:"yes",color:"primary"},on:{click:function(t){e.actionConfirmAlert=!1,e.processRequest(!1,!1)}}})]},proxy:!0}]),model:{value:e.actionConfirmAlert,callback:function(t){e.actionConfirmAlert=t},expression:"actionConfirmAlert"}})],2)},o=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"footer"},[t("div",{staticClass:"label"},[e._v("Powered by")]),t("img",{attrs:{src:s("0c4b"),alt:"logo"}})])}],a=(s("14d9"),s("7bb1")),r=s("1b0d"),n=s("2f62"),l=s("c49c"),d=s("fd26"),c=s("4bc4"),h=s("381e"),u=s("a7d2"),f=s("dd90"),m=s("bc3a"),p=s.n(m),y=s("fa1f"),v=s("6df3"),w=s("6a70"),g=s("1c54"),b=s("695e"),C=s("cade"),k=s("ee54"),I=s("98cf"),_=s("909a"),S=s("9996"),F=s("8505"),A=s("8bc3"),$={name:"ExternalRequest",components:{ValidationObserver:a["a"],ValidationProvider:a["b"],StateWrapper:l["a"],ThemeSwitcher:d["a"],RenderForm:c["a"],Sheet:h["a"],FileIcon:y["a"],TextAreaField:v["a"],Confirm:g["a"],Modal:w["a"],TextBuilderField:b["a"],ListItem:C["a"],MetaDataEdit:k["a"],ProcessHistory:F["a"],PasswordField:A["a"]},props:{tenantId:{type:String,required:!0},userId:{type:String,required:!0},workflowId:{type:String,required:!0},processId:{type:String,required:!0}},data(){return{loadingBarContent:!0,formWidth:"100%",title:"",description:"",workflow:{},formId:0,form:null,formModel:{},tabs:[{id:this.$nano.id(),label:"attachments",name:"attachmentsCount",value:"ATTACHMENTS",icon:"mdi-attachment",count:0},{id:this.$nano.id(),label:"comments",name:"commentsCount",value:"COMMENTS",icon:"mdi-comment-text-outline",count:0},{id:this.$nano.id(),label:"history",value:"HISTORY",icon:"mdi-history",count:0}],attachmentLoad:null,attachmentSheet:!1,commentsLoad:null,commentsSheet:!1,commentText:"",commentsList:[],advancedCommentsSheet:!1,advancedCommentText:"",attachmentList:[],fileSheet:!1,selectedFile:{},isLoading:!1,selectedProcess:{},checkList:[],docWarning:!1,rowIndex:null,processActions:[],processActionsAddOn:[],actionText:"",actionRemarks:!1,actionPassword:!1,actionPasswordConfirm:!1,actionUserPassword:"",actionComments:!1,actionConfirm:!1,actionConfirmAlert:!1,workflowFormModel:{},saveAction:"",generatePDF:0,successModal:!1,alertModal:!1,formEditAccess:!1,formEditControls:[],readonlyControls:[],formVisibilityAccess:!0,formSecureControls:[],userSignature:!1,customReply:!1,processForwardModal:!1,internalForward:{proceed:!1,users:[],groups:[]},userList:[],groupList:[],forwardUsers:[],forwardGroups:[],documentActionList:[{id:"Download",key:"download",label:"Download",icon:"mdi-download-outline"},{id:"Print",key:"print",label:"Print",icon:"eva-printer-outline"}],repositoryDetails:[],repositoryField:[],showMetaDataEditModal:!1,selectedUploadFile:{},uploadFilename:"",fileData:[],workflowModel:{},historyProcessId:0,formUploadFiles:[],mandatory:{},fileControlDeleteFile:[],hasCheckFormValidate:!1,formFields:[],subWorkflowFormList:[],fileUploadForControl:!1,fileUploadInput:{},metaDataModal:{},metaDataTitle:"",formView:!1,portalMasterFormId:0,portalSettingJson:{},masterFormFields:[],fileUploadRequired:!1,mandatoryDocument:[],ocrResult:[],requestFormData:{},watchViewerClose:null}},computed:{...Object(n["c"])(["darkTheme"]),panels(){return this.formId?this.form.panels:[]},secondaryPanels(){return this.formId?this.form.secondaryPanels:[]},formSettings(){return this.formId?this.form.settings:{}},checkListTemplate(){return!!this.checkList.length&&this.checkList.filter(e=>e.template).length>0},_enableControls(){let e=[],t=[];return this.panels.forEach(s=>{if(s.fields.length){let i=s.fields.filter(e=>"SINGLE_SELECT"===e.type||"SINGLE_CHOICE"===e.type||"MULTIPLE_CHOICE"===e.type||"MULTI_SELECT"===e.type);i.length&&i.forEach(s=>{if(s.settings.validation.enableSettings&&s.settings.validation.enableSettings.length){let i=[];s.settings.validation.enableSettings.forEach(e=>{e.controls.length&&(i.push({value:e.value,childControls:e.controls}),e.controls.forEach(e=>{i.indexOf(e)<0&&t.push(e)}))}),i.length&&e.push({id:s.id,parentControls:i})}})}}),{listControls:t,controls:e}},_columns(){let e=[];return this.panels.forEach(t=>{if(t.fields.length)for(let s of t.fields)"DIVIDER"===s.type||"LABEL"===s.type||"PARAGRAPH"===s.type||!s.label&&"TABLE"!==s.type||"DISABLE"===s.settings.general.visibility||e.push({id:this.$nano.id(),name:s.id,label:s.label,type:s.type,isVisible:!0,isSortable:!0,isGroupable:!1})}),e},mandatoryFilling(){return this.mandatory.filledValue&&this.mandatory.nonFilledValue?Math.floor(this.mandatory.filledValue/(this.mandatory.filledValue+this.mandatory.nonFilledValue)*100):this.mandatory.filledValue?100:0}},watch:{userId:{immediate:!0,handler:"getSession"},workflowFormModel:{deep:!0,immediate:!0,handler(){this.workflowFormModel&&this.saveAction&&this.checkRequiredDocuments()}},saveAction:{immediate:!0,handler(){this.saveAction&&!this.formView&&(this.workflowFormModel=this.selectedProcess.formData.fields,this.checkRequiredDocuments())}},checkList:{deep:!0,immediate:!0,handler(){if(this.checkList.length){let e=[];this.checkList.forEach(t=>{t.required&&!t.attach&&e.push(t)}),this.mandatoryDocument=e}}},fileUploadRequired:{immediate:!0,handler(){if(this.checkList.length){let e=[];this.checkList.forEach(t=>{t.required&&!t.attach&&e.push(t)}),this.mandatoryDocument=e}}},attachmentSheet:{immediate:!0,handler(){this.attachmentSheet&&this.selectedProcess.processId?this.attachmentLoad=setInterval(()=>{this.getAttachments()},15e3):clearInterval(this.attachmentLoad)}},commentsSheet:{immediate:!0,handler(){this.commentsSheet&&this.selectedProcess.processId?this.commentsLoad=setInterval(()=>{this.getComments()},3e4):clearInterval(this.commentsLoad)}}},methods:{checkDocument(){this.docWarning=!1,this.checkList.length&&this.checkList.forEach(e=>{e.required&&!e.attach&&(this.docWarning=!0)})},checkRequiredDocuments(){let e=[];e=this.checkList.filter(e=>e.required&&!e.attach),e.length?this.docWarning?this.alertModal=!0:(this.$alert.warning("Mandatory documents required"),this.saveAction="",this.workflowFormModel={}):this.processRequest()},async showLinks(e){"ATTACHMENTS"===e?(this.attachmentList=[],this.attachmentSheet=!0,await this.getAttachments()):"COMMENTS"===e?(this.commentsList=[],this.commentsSheet=!0,await this.getComments()):"HISTORY"===e&&(this.historyProcessId=this.selectedProcess.processId)},closeAlertModal(){this.saveAction="",this.workflowFormModel={},this.alertModal=!1},closeSuccessModal(){location.reload()},lastCommentDuration(e){const t=e.createdAt instanceof Date?e.createdAt:new Date(e.createdAt),s=new Intl.RelativeTimeFormat("en"),i={years:31536e3,months:2592e3,weeks:604800,days:86400,hours:3600,minutes:60,seconds:1},o=(t.getTime()-Date.now())/1e3;for(let a in i)if(i[a]<Math.abs(o)){const e=o/i[a];return s.format(Math.round(e),a)}},fileType(e){if(e)return e.split(".").reverse()[0].slice(0,4)},fileSize(e){return Object(u["a"])(e)},fileLink(){let e=location.origin.replace("http://localhost:8080","http://52.172.32.88");if(this.selectedFile.name){let t=this.selectedFile.name.split(".").pop();return this.selectedFile.initiate?Object(f["d"])(t)?"https://ag-appsvc01.azurewebsites.net"===e||"https://ag-appsvc05.azurewebsites.net"===e?`https://ag-appsvc04.azurewebsites.net/web/viewer.html?tId=${this.$store.state.session.tenantId}&uploadId=${this.selectedFile.id}&type=1`:"https://trial.ezofis.com"===e?`https://trial.ezofis.com/docsviewer/index.html?tId=${this.$store.state.session.tenantId}&uploadId=${this.selectedFile.id}&type=1`:"https://app.ezofis.com"===e?`https://ezdocsviewer.azurewebsites.net/web/viewer.html?tId=${this.$store.state.session.tenantId}&uploadId=${this.selectedFile.id}&type=1`:`${e}/PDFViewer/web/viewer.html?tId=${this.$store.state.session.tenantId}&uploadId=${this.selectedFile.id}&type=1`:"http://52.172.32.88"===e?`http://52.172.32.88/DocsViewer/index.html?tId=${this.$store.state.session.tenantId}&uploadId=${this.selectedFile.id}&type=1`:`https://appuat.ezofis.com/ezofisapi/api/uploadandindex/view/${this.$store.state.session.tenantId}/${this.selectedFile.id}/1`:Object(f["d"])(t)?"https://ag-appsvc01.azurewebsites.net"===e||"https://ag-appsvc05.azurewebsites.net"===e?`https://ag-appsvc04.azurewebsites.net/web/viewer.html?tId=${this.$store.state.session.tenantId}&uId=${this.$store.state.session.id}&rId=${this.selectedFile.repositoryId}&itemId=${this.selectedFile.id}&type=2&filename=${this.selectedFile.name}`:"https://trial.ezofis.com"!==e||Object(f["c"])(t)?"https://app.ezofis.com"===e?`https://ezdocsviewer.azurewebsites.net/web/viewer.html?tId=${this.$store.state.session.tenantId}&uId=${this.$store.state.session.id}&rId=${this.selectedFile.repositoryId}&itemId=${this.selectedFile.id}&wId=${this.workflow.id}&pId=${this.selectedProcess.processId}&type=2&filename=${this.selectedFile.name}&action=download,print`:`${e}/PDFViewer/web/viewer.html?tId=${this.$store.state.session.tenantId}&uId=${this.$store.state.session.id}&rId=${this.selectedFile.repositoryId}&itemId=${this.selectedFile.id}&wId=${this.workflow.id}&pId=${this.selectedProcess.processId}&type=2&filename=${this.selectedFile.name}&action=download,print`:`https://trial.ezofis.com/docsviewer/index.html?tId=${this.$store.state.session.tenantId}&uId=${this.$store.state.session.id}&rId=${this.selectedFile.repositoryId}&itemId=${this.selectedFile.id}&wId=${this.workflow.id}&pId=${this.selectedProcess.processId}&type=2&filename=${this.selectedFile.name}&action=download,print`:Object(f["b"])(t)||"http://52.172.32.88"!==e?`https://appuat.ezofis.com/ezofisapi/api/file/view/${this.$store.state.session.tenantId}/${this.$store.state.session.id}/${this.selectedFile.repositoryId}/${this.selectedFile.id}/2`:`http://52.172.32.88/DocsViewer/index.html?tId=${this.$store.state.session.tenantId}&uId=${this.$store.state.session.id}&rId=${this.selectedFile.repositoryId}&itemId=${this.selectedFile.id}&type=2&filename=${this.selectedFile.name}`}},openFile(e){this.selectedFile=e;let t=location.origin;"https://ag-appsvc01.azurewebsites.net"===t||"https://ag-appsvc05.azurewebsites.net"===t||(this.fileSheet=!0)},download(e){window.open(`https://appuat.ezofis.com/ezofisapi/api/workflow/viewChecklist?wId=${this.workflowId}&id=${e}`)},downloadAll(){this.checkList.forEach(e=>{e.id&&e.template&&window.open(`https://appuat.ezofis.com/ezofisapi/api/workflow/viewChecklist?wId=${this.workflowId}&id=${e.id}`)})},attachTemplate(e){this.rowIndex=e,this.$refs.attachments.click()},lastActionDuration(e){const t=e.transaction_createdAt instanceof Date?e.transaction_createdAt:new Date(e.transaction_createdAt),s=new Intl.RelativeTimeFormat("en"),i={years:31536e3,months:2592e3,weeks:604800,days:86400,hours:3600,minutes:60,seconds:1},o=(t.getTime()-Date.now())/1e3;for(let a in i)if(i[a]<Math.abs(o)){const e=o/i[a];return s.format(Math.round(e),a)}},fileMenuAction(e,t){this.selectedFile=e,this.documentAction(t)},documentAction(e){if("Email_Sharing"===e);else if("Print"===e){if(this.selectedFile.name){let e=this.selectedFile.name.split(".").pop();Object(f["d"])(e)?(localStorage.setItem("filePrint",!0),localStorage.setItem("filePrintId",this.selectedFile.id)):this.$refs.myFiles.contentWindow.print()}this.filePrintSession()}else if("Download"===e){let e="";e=`https://appuat.ezofis.com/ezofisapi/api/menu/file/download/${this.$store.state.session.tenantId}/${this.$store.state.session.id}/${this.selectedFile.repositoryId}/${this.selectedFile.id}/2`,window.open(e,"_blank")}},mandatoryControlsList(e){this.mandatory=e},deletedFiles(e,t){if(this.fileControlDeleteFile.push(e),t){console.log(t),t.controls.length&&t.controls.forEach(e=>{this.workflowModel[e]=""});let e=this.attachmentList.findIndex(e=>e.name===t.file.name&&e.id===t.file.fileId&&e.fileControl);e>=0&&(this.tabs.find(e=>{"ATTACHMENTS"===e.value&&(e.count=this.attachmentList.length-1)}),this.attachmentList.splice(e,1))}},checkFormValidation(){this.hasCheckFormValidate=!0},validateType(e){let t="";return this.form.panels.forEach(s=>{if(!s.fields.length)return;let i=s.fields.find(t=>t.id===e);i&&(t=i.type)}),t},getLabel(e,t){let s="";return this.form.panels.forEach(i=>{if(i.fields.length)for(let o of i.fields)if("table"===t){const t=o.settings.specific.tableColumns.find(t=>t.id===e);t&&(s=t.label)}else if(o.id===e&&!1===o.settings.general.hideLabel)return void(s=o.label)}),s},validateValue(e){let t=/^(?:(?:https?|ftp):\/\/)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/\S*)?$/;return!t.test(e)},removeTags(e){return e?e.replace(/(<([^>]+)>)/gi,""):""},tableValue(e){return e?JSON.parse(e):[]},validateTypeValue(e){if(e)try{var t=JSON.parse(e);if("object"===typeof t)return t}catch(s){return e}return e},transformFormDataToPanelsArray(e,t){const s={formId:e.formId,formEntryId:e.formEntryId,panels:[]};return t.forEach((t,i)=>{const o=t.settings.title,a=t.fields,r={name:o,panelsExpandView:0===i,fields:{}};a.forEach(t=>{const s=t.id,i=e.fields[s]||"";r.fields[s]=i}),s.panels.push(r)}),s},itemLink(){let e=location.origin.replace("http://localhost:8080","http://52.172.32.88"),t="";return t="https://trial.ezofis.com"===e?"https://trial.ezofis.com/docsviewer/index.html":"http://52.172.32.88"===e?"http://52.172.32.88/DocsViewer/index.html":e+"/PDFViewer/web/viewer.html","DOCUMENT_SIGN"===this.workflow.initiatedBy&&this.selectedProcess.activityUserEmail===this.$store.state.session.email?(localStorage.setItem("signItemId",0),localStorage.setItem("viewerClose",!1),this.watchViewerClose=setInterval(()=>this.checkViewerClose(),1e3),`${t}?tId=${this.$store.state.session.tenantId}&uId=${this.$store.state.session.id}&rId=${this.selectedProcess.itemData.repositoryId}&itemId=${this.selectedProcess.itemData.itemId}&wId=${this.workflow.id}&pId=${this.selectedProcess.processId}&type=2&signature=true&getSign=true&uniqId=${this.selectedProcess.raisedByUserId}`):`${t}?tId=${this.$store.state.session.tenantId}&uId=${this.$store.state.session.id}&rId=${this.selectedProcess.itemData.repositoryId}&itemId=${this.selectedProcess.itemData.itemId}&wId=${this.workflow.id}&pId=${this.selectedProcess.processId}&type=2`},async validatePassword(){const e=await this.$refs.passwordForm.validate();if(!e)return;this.isLoading=!0;const{error:t}=await r["a"].validatePassword({password:this.actionUserPassword});if(this.isLoading=!1,t)return console.log(t),void this.$alert.warning(t);this.actionUserPassword="",this.actionPasswordConfirm=!1,this.actionRemarks?(this.actionComments=!0,this.advancedCommentsSheet=!0):(this.actionRemarks=!1,this.actionPassword=!1,this.processRequest(!1,!1))},async getSession(){const{error:e}=await r["a"].externalLogin(this.tenantId,this.userId);e?this.$alert.info("User Account Not Found"):this.getProcess()},async getProcess(){this.$store.commit("showLoadingBar");let e=[];e=this.userId.indexOf("ES")>0?[{filters:[{criteria:"processId",condition:"IS_EQUALS_TO",value:this.processId}]}]:[{filters:[{criteria:"processId",condition:"IS_EQUALS_TO",value:this.processId},{criteria:"actionUser",condition:"IS_EQUALS_TO",value:this.userId}]}];const{error:t,payload:s}=await r["o"].getWorkflowData(this.workflowId,{filterBy:e,itemsPerPage:10,currentPage:1});if(t)return this.$store.commit("hideLoadingBar"),void this.$alert.error(t);if(s.meta.totalItems&&s.data.length&&s.data[0].value.length){if(this.selectedProcess=s.data[0].value[0],this.title=this.selectedProcess.requestNo,console.log(this.selectedProcess),this.selectedProcess.formData){let e=Object.keys(this.selectedProcess.formData.fields),t={};e.forEach(e=>{t[e]=this.validateTypeValue(this.selectedProcess.formData.fields[e])}),this.formModel=t}this.tabs.find(e=>{"COMMENTS"===e.value&&(e.count=this.selectedProcess.commentsCount)}),this.tabs.find(e=>{"ATTACHMENTS"===e.value&&(e.count=this.selectedProcess.attachmentCount)}),this.getWorkflow()}},async getWorkflow(){const{error:e,payload:t}=await r["t"].getWorkflow(this.workflowId);if(this.$store.commit("hideLoadingBar"),e)return void this.$alert.error(e);this.workflow=t;let s=JSON.parse(this.workflow.flowJson);if(this.processActions=[],this.processActionsAddOn=[],s.rules.forEach(e=>{e.fromBlockId===this.selectedProcess.activityId&&this.processActions.indexOf(e.proceedAction)<0&&(this.processActions.push(e.proceedAction),this.processActionsAddOn.push({action:e.proceedAction,remarks:e.remarks||!1,passwordAccess:e.passwordAccess||!1,confirm:e.confirm||!1}))}),"DOCUMENT_SIGN"!==this.workflow.initiatedBy){if(s.settings.general.initiateUsing.formId&&this.getForm(s.settings.general.initiateUsing.formId),this.description=`${this.workflow.name} - ${this.selectedProcess.stage}`,this.formEditAccess=!0,this.selectedProcess.activityUserEmail===this.$store.state.session.email){let e=s.blocks.find(e=>e.id===this.selectedProcess.activityId);if(e&&("Forward"===this.selectedProcess.lastAction&&"REPLY"===e.settings.forwardedUserAction?(this.processActions.push("Reply to "+this.selectedProcess.transaction_createdByEmail),this.processActionsAddOn.push({action:"Reply to "+this.selectedProcess.transaction_createdByEmail,remarks:!0,passwordAccess:!1,confirm:!1}),this.customReply=!0):(e.settings.userReply&&-1===this.processActions.indexOf("Reply")&&(this.processActions.push("Reply to "+this.selectedProcess.lastActionStageName),this.userReply=!0),e.settings.toInitiator&&-1===this.processActions.indexOf("To Requester")&&(this.processActions.push("To Requester"),this.toRequester=!0),e.settings.internalForward&&(this.processActions.push("Forward"),this.internalForward.proceed=!0,this.internalForward.users=[],this.internalForward.groups=[],e.settings.internalForwardUser?e.settings.internalForwardUser.length&&e.settings.internalForwardUser.forEach(e=>{let t=this.userList.filter(t=>t.value==e);t.length&&this.internalForward.users.push({id:this.$nano.id(),label:t[0].label,value:e})}):this.getUsers(),e.settings.internalForwardGroup?e.settings.internalForwardGroup.length&&e.settings.internalForwardGroup.forEach(e=>{let t=this.groupList.filter(t=>t.value==e);t.length&&this.internalForward.groups.push({id:this.$nano.id(),label:t[0].label,value:e})}):this.getGroups())),this.userSignature=e.settings.userSignature,e.settings.fileSettings&&e.settings.fileSettings.fileCheckList.length&&(this.checkList=e.settings.fileSettings.fileCheckList,this.checkList.forEach(e=>{e.uid=this.$nano.id(),e.attach=!1,this.fileUploadRequired=!this.fileUploadRequired}),this.docWarning=e.settings.fileSettings.partial),e.settings.formEditAccess&&(""===e.settings.formEditAccess?(this.formEditAccess=!0,this.formEditControls=[]):"FULL"===e.settings.formEditAccess?(this.formEditAccess=!1,this.formEditControls=[]):"PARTIAL"===e.settings.formEditAccess&&(this.formEditAccess=!1,this.formEditControls=e.settings.formEditControls)),e.settings.formVisibilityAccess?(this.formVisibilityAccess=!0,this.formSecureControls=[]):(this.formVisibilityAccess=!1,this.formSecureControls=e.settings.formSecureControls),s.settings.general.processNumberPrefix.indexOf("[")>-1)){let e=JSON.parse(s.settings.general.processNumberPrefix);this.readonlyControls=[];let t=e.filter(e=>"formColumn"===e.key);t.length&&t.forEach(e=>{this.readonlyControls.push(e.value),this.formEditControls.splice(this.formEditControls.indexOf(e.value),1)})}}this.workflow.repositoryId&&this.getRepository()}else this.loadingBarContent=!1},async getForm(e){const{error:t,payload:s}=await r["g"].getForm(e);if(t)return void this.$alert.error(t);this.form=JSON.parse(s.formJson),this.formId=e.toString();const i=[...this.form.panels,...this.form.secondaryPanels];if(!i.length)return;let o=[];for(const a of i)o.push(...a.fields);o.forEach(e=>{"DIVIDER"===e.type||"LABEL"===e.type||"PARAGRAPH"===e.type||!e.label&&"TABLE"!==e.type||"DISABLE"===e.settings.general.visibility||this.formFields.push({id:this.$nano.id(),label:e.label||e.type,value:e.id,type:e.type,settings:e.settings})}),this.requestFormData=await this.transformFormDataToPanelsArray(this.selectedProcess.formData,this.form.panels),this.loadingBarContent=!1},async getRepository(){const{error:e,payload:t}=await r["p"].getRepository(this.workflow.repositoryId);e?this.$alert.error(e):(this.repositoryDetails=t,this.repositoryField=t.fields)},async getUsers(){this.userList=[];const{error:e,payload:t}=await r["s"].getUserList();e?this.$alert.error("Error fetching users"):t&&t.map(e=>{e.id!==this.$store.state.session.id&&this.userList.push({id:this.$nano.id(),label:e.value,value:e.id})})},async getGroups(){const{error:e,payload:t}=await r["i"].getGroupList();e?this.$alert.error("Error fetching groups"):this.groupList=t&&t.map(e=>({id:this.$nano.id(),label:e.value,value:e.id}))},saveMetaData(e){let t=[];if(this.repositoryField.forEach(s=>{t.push({name:s.name,value:e[s.name],type:s.dataType})}),t.forEach(e=>{let t=this.formFields.find(t=>Object(S["a"])(t.label)===Object(S["a"])(e.name));t&&e.value&&(this.workflowModel[t.value]=e.value)}),this.fileUploadForControl){this.metaDataModal=e;let s=this.fileUploadInput;this.uploadFilesFromForm(s.files,s.control,s.fieldId,JSON.stringify(t))}else this.uploadAttachments(this.selectedUploadFile,JSON.stringify(t))},closeMetaDataEditModal(){this.showMetaDataEditModal=!1,this.$refs.attachments&&(this.$refs.attachments.value=null)},async getComments(){this.tabs.find(e=>{"COMMENTS"===e.value&&(e.count=0)}),this.commentsList=[],this.$store.commit("showLoadingBar");const{error:e,payload:t}=await r["t"].getProcessComments(this.workflow.id,this.selectedProcess.processId);this.$store.commit("hideLoadingBar"),e?this.$alert.error(e):t.length&&(this.commentsList=t,this.tabs.find(e=>{"COMMENTS"===e.value&&(e.count=this.commentsList.length)}))},async saveComment(){if(this.commentText)if(this.selectedProcess.processId){this.$store.commit("showLoadingBar");const{error:e}=await r["t"].insertProcessComment(this.workflow.id,this.selectedProcess.processId,this.selectedProcess.transactionId,{comments:this.commentText,showTo:this.commentAction});if(this.$store.commit("hideLoadingBar"),e)return void this.$alert.error(e);this.commentText="",this.getComments()}else this.commentsList.push({comments:this.commentText,createdAt:(new Date).toISOString(),createdBy:this.$store.state.session.id}),this.tabs.find(e=>{"COMMENTS"===e.value&&(e.count=this.commentsList.length)}),this.commentText=""},async saveAdvancedComment(){if(this.advancedCommentText){if(this.selectedProcess.processId){this.$store.commit("showLoadingBar");const{error:e}=await r["t"].insertProcessComment(this.workflow.id,this.selectedProcess.processId,this.selectedProcess.transactionId,{comments:this.advancedCommentText,showTo:this.commentAction});if(this.$store.commit("hideLoadingBar"),e)return void this.$alert.error(e);this.advancedCommentText="",this.advancedCommentsSheet=!1,this.getComments()}else this.commentsList.push({comments:this.advancedCommentText,createdAt:(new Date).toISOString(),createdBy:this.$store.state.session.id}),this.tabs.find(e=>{"COMMENTS"===e.value&&(e.count=this.commentsList.length)}),this.advancedCommentText="",this.advancedCommentsSheet=!1;this.actionComments&&this.processRequest(!1,!1)}},async uploadWflowAttachments(e){this.fileUploadForControl=!1,"STATIC"===this.repositoryDetails.fieldsType?(this.selectedUploadFile=e,this.uploadFilename=e.target.files[0].name,this.showMetaDataEditModal=!0):this.uploadAttachments(e)},async uploadAttachments(e,t){if(this.selectedProcess.processId){const t=e.target.files[0],i=new FormData;i.append("workflowId",this.workflow.id),i.append("repositoryId",this.workflow.repositoryId),i.append("processId",this.selectedProcess.processId),i.append("transactionId",this.selectedProcess.transactionId),i.append("fields",""),i.append("file",t);let o=e.target.files[0].name;const a=o.split(".").pop();if(this.rowIndex){let e=this.checkList.filter(e=>e.uid===this.rowIndex);i.append("filename",e[0].name+"."+a),o=e[0].name+"."+a}if(!Object(f["a"])(a))return void this.$alert.info("This file format is not supported");this.$store.commit("showLoadingBar");try{const t=await p()({url:"https://appuat.ezofis.com/ezofisapi/api/workflow/attachmentWithProcessId",method:"POST",data:i,headers:{Token:this.$store.state.identity.token,Accept:"application/json","Content-Type":"multipart/form-data"}}),{status:s,data:o}=t;if(e.target.value="",200!==s||!o)throw t;this.$alert.success("Document attached")}catch(s){this.$alert.error("Error uploading file"),console.error(s)}this.$store.commit("hideLoadingBar"),this.checkList.length&&this.checkList.forEach(e=>{if(e.uid===this.rowIndex)return e.attach=!0,void(this.fileUploadRequired=!this.fileUploadRequired)}),e.target.value=""}else{const i=e.target.files[0],o=new FormData;o.append("file",i),o.append("repositoryId",this.workflow.repositoryId),t&&(this.fileData=JSON.parse(t),o.append("fields",t));let a=e.target.files[0].name;const r=a.split(".").pop();if(this.rowIndex){let e=this.checkList.filter(e=>e.uid===this.rowIndex);o.append("filename",e[0].name+"."+r),a=e[0].name+"."+r}if(!Object(f["a"])(r))return void this.$alert.info("This file format is not supported");this.$store.commit("showLoadingBar");try{const t=await p()({url:"https://appuat.ezofis.com/ezofisapi/api/uploadAndIndex/upload",method:"POST",data:o,headers:{Token:this.$store.state.identity.token,Accept:"application/json","Content-Type":"multipart/form-data"}});this.$store.commit("hideLoadingBar");const{status:s,data:r}=t;if(e.target.value="",200!==s)throw"Invalid response";let n=JSON.parse(r);this.attachmentList.push({id:Number(n.fileId),name:a,createdAt:(new Date).toISOString(),createdByEmail:this.$store.state.session.email,size:i.size,initiate:!0,uid:this.rowIndex}),this.$alert.success("Document attached"),this.tabs.find(e=>{"ATTACHMENTS"===e.value&&(e.count=this.attachmentList.length)}),this.checkList.length&&this.checkList.forEach(e=>{if(e.uid===this.rowIndex)return e.attach=!0,void(this.fileUploadRequired=!this.fileUploadRequired)})}catch(s){console.error(s),this.$alert.error("error attaching file")}}},async getAttachments(){if(this.tabs.find(e=>{"ATTACHMENTS"===e.value&&(e.count=0)}),this.checkList=[],this.selectedProcess.processId){let e=JSON.parse(this.workflow.flowJson),t=e.blocks.find(e=>e.id===this.selectedProcess.activityId);t&&t.settings.fileSettings&&t.settings.fileSettings.fileCheckList.length&&(this.checkList=t.settings.fileSettings.fileCheckList,this.checkList.forEach(e=>{e.uid=this.$nano.id(),e.attach=!1,this.fileUploadRequired=!this.fileUploadRequired}));let s=this.attachmentList.length;this.$store.commit("showLoadingBar");const{error:i,payload:o}=await r["t"].getAttachments(this.workflow.id,this.selectedProcess.processId);if(this.$store.commit("hideLoadingBar"),i)return void this.$alert.error(i);o.length?(this.tabs.find(e=>{"ATTACHMENTS"===e.value&&(e.count=o.length)}),s!==o.length&&(this.attachmentList=o.map(e=>({...e,checked:!1})))):this.attachmentList=[],this.checkList.length&&(this.checkList.forEach(e=>{let t=this.attachmentList.filter(t=>{let s=t.name.substr(0,t.name.lastIndexOf("."));if(e.name===s)return t});t.length?e.attach=!0:e.attach=!1,this.fileUploadRequired=!this.fileUploadRequired}),this.tabs.find(e=>{"ATTACHMENTS"===e.value&&(e.count=this.attachmentList.length)}))}},async attachmentDelete(e){if(e.fileControl){let t=this.workflowModel[e.fieldId];if(t.length){let s=t.findIndex(t=>t.fileId===e.id);s>=0&&this.workflowModel[e.fieldId].splice(s,1);let i=this.formUploadFiles.findIndex(t=>t.fileId===e.id&&t.fileId===e.fileId);i>=0&&this.formUploadFiles.splice(s,1),e.control.length&&e.control.forEach(e=>{this.workflowModel[e]=""})}let s=this.attachmentList.findIndex(e=>e.fileControl);s>=0&&(this.tabs.find(e=>{"ATTACHMENTS"===e.value&&(e.count=this.attachmentList.length-1)}),this.attachmentList.splice(s,1))}else if(this.$store.commit("showLoadingBar"),e.initiate){const{error:t}=await r["r"].deleteUploadedFiles([e.id]);if(t)return void this.$alert.error(t);this.$store.commit("hideLoadingBar"),this.attachmentList=this.attachmentList.filter(t=>t.id!==e.id),this.checkList.forEach(t=>{t.uid===e.uid&&(t.attach=!1,this.fileUploadRequired=!this.fileUploadRequired)}),this.tabs.find(e=>{"ATTACHMENTS"===e.value&&(e.count=this.attachmentList.length)})}else{const{error:t}=await r["p"].fileDelete(this.workflow.repositoryId,e.id);if(t)return void this.$alert.error(t);this.$store.commit("hideLoadingBar"),this.getAttachments()}},async getOCRResult(e,t,s){const i=new FormData;let o=[];if(t&&t.length){if(t.forEach(e=>{this.readonlyControls.push(e)}),t.forEach(e=>{let t=this.formFields.find(t=>t.value===e);t&&o.push(`${t.label}, ${t.type}`)}),e.length){for(let t of e){if(t.name&&!t.error){i.append("repositoryId",this.workflow.repositoryId),i.append("file",t),o.length&&i.append("formFields",JSON.stringify(o));try{const e=await p()({url:"https://appuat.ezofis.com/ezofisapi/api/uploadAndIndex/uploadforStaticMetadata",method:"POST",data:i,headers:{Token:this.$store.state.identity.token,Accept:"application/json","Content-Type":"multipart/form-data"},onUploadProgress:function(e){let i=Math.round(100*e.loaded/e.total),o=this.workflowModel[s].findIndex(e=>e.name===t.name);o>=0&&(this.$set(this.workflowModel[s][o],"uploadedPercentage",0),this.workflowModel[s][o].uploadedPercentage=i<50?i:49)}.bind(this)}),{status:o,data:a}=e;if(200!==o)throw"Invalid response";console.log(a);let r=Object(_["a"])(a,this.$store.state.identity.key,this.$store.state.identity.iv);console.log(r);let n=JSON.parse(r),l=JSON.parse(n),d=JSON.parse(l);Array.isArray(d)&&(d.forEach(e=>{let t=this.formFields.find(t=>t.label===e.name);t&&e.value&&(this.workflowModel[t.value]=e.value)}),this.ocrResult=d)}catch(a){console.error(a),this.$alert.error("error on get ocr result")}}this.workflowModel[s].findIndex(e=>e.name===t.name)}this.$store.commit("hideLoadingBarSave"),this.uploadFileForControl(e,t,s)}}else this.uploadFileForControl(e,t,s)},async uploadFilesFromForm(e,t,s,i){this.formUploadFiles=[];const o=new FormData;if(e.length){for(let n of e){if(n.name&&!n.error){o.append("repositoryId",this.workflow.repositoryId),o.append("file",n),o.append("filename",n.name),i?o.append("fields",i):o.append("fields","");try{const e=await p()({url:"https://appuat.ezofis.com/ezofisapi/api/uploadAndIndex/upload",method:"POST",data:o,headers:{Token:this.$store.state.identity.token,Accept:"application/json","Content-Type":"multipart/form-data"},onUploadProgress:function(e){let t=Math.round(100*e.loaded/e.total),i=this.workflowModel[s].findIndex(e=>e.name===n.name);i>=0&&(this.$set(this.workflowModel[s][i],"uploadedPercentage",0),this.workflowModel[s][i].uploadedPercentage=t>50&&100!==t?t:98)}.bind(this)}),{status:i,data:a}=e;if(200!==i)throw"Invalid response";n.createdAt=this.$day.newDateTime(),n.createdBy=this.$store.state.session.email;let r=JSON.parse(a);n.fileId=r.fileId,n.fieldId=s,this.attachmentList.push({id:Number(r.fileId),name:n.name,createdAt:(new Date).toISOString(),createdByEmail:this.$store.state.session.email,size:n.size,initiate:!0,formAttach:!0,fileControl:!0,fieldId:s,control:t}),this.tabs.find(e=>{"ATTACHMENTS"===e.value&&(e.count=this.attachmentList.length)})}catch(a){console.error(a),this.$alert.error("error attaching file")}}let e=this.workflowModel[s].findIndex(e=>e.name===n.name);e>=0&&(this.workflowModel[s][e].uploadedPercentage=100)}let r=Array.from(e);this.formUploadFiles=[];for(let e of r)if(e.name){const t=await Object(I["a"])(e);this.formUploadFiles.push({name:e.name,size:e.size,file:t,fileId:e.fileId,createdBy:e.createdBy,createdAt:e.createdAt,workflowId:this.selectedProcess.id,processId:this.selectedProcess.processId,fieldId:e.fieldId})}t.forEach(e=>{let t=this.readonlyControls.findIndex(t=>t===e);t>=0&&this.readonlyControls.splice(t,1)}),this.$store.commit("hideLoadingBarSave")}},async fileControlDeletedFile(e){this.$store.commit("showLoadingBar");let t=[];e.forEach(e=>{e.id&&t.push(e.id)});let s={ids:t,formInfo:{formId:this.formId,formEntryId:this.selectedProcess.formData.formEntryId,jsonId:e[0].jsonId}};const{error:i}=await r["p"].fileControlDeleteFile(this.workflow.repositoryId,s);this.$store.commit("hideLoadingBar"),i&&this.$alert.error(i)},async processRequest(e=!0,t=!0){if(e&&"Forward"===this.saveAction&&this.internalForward.proceed)return this.processForwardGroupAction=!1,void(this.processForwardModal=!0);if(t){let e=this.processActionsAddOn.find(e=>e.action===this.saveAction);if(e&&Object.keys(e).length){if(this.actionRemarks=e.remarks,this.actionPassword=e.passwordAccess,this.actionConfirm=e.confirm,this.actionPassword)return void(this.actionPasswordConfirm=!0);if(this.actionRemarks)return this.actionComments=!0,void(this.advancedCommentsSheet=!0);if(this.actionConfirm)return void(this.actionConfirmAlert=!0)}}let s={};this.formId?s={workflowId:this.workflow.id,transactionId:this.selectedProcess.transactionId,review:"Save"===this.saveAction?"":this.saveAction,formData:{formId:this.formId,formEntryId:this.selectedProcess.formData.formEntryId,fields:this.workflowFormModel}}:this.selectedProcess&&(s={workflowId:this.workflow.id,transactionId:this.selectedProcess.transactionId,review:"Signed",formData:{},userIds:this.forwardUsers,groupIds:this.forwardGroups}),this.saveAction="",this.workflowFormModel={},this.loadingBarContent=!0;const{error:i}=await r["t"].processTransaction(s);this.loadingBarContent=!1,i?this.$alert.error(i):(""===s.review?this.$alert.info(this.selectedProcess.requestNo+" data saved, awaiting your action to submit"):(this.processActions=[],this.successModal=!0),this.fileControlDeleteFile.length&&(this.fileControlDeleteFile.forEach(e=>{this.fileControlDeletedFile(e)}),this.fileControlDeleteFile=[]))},checkViewerClose(){localStorage.getItem("viewerClose")&&"true"===localStorage.getItem("viewerClose")&&(localStorage.removeItem("viewerClose"),clearInterval(this.watchViewerClose),"DOCUMENT_SIGN"===this.workflow.initiatedBy&&this.getSignerSettings())},async getSignerSettings(){this.forwardUsers=[];let e=this.selectedProcess.itemData.itemId.toString();localStorage.getItem("signItemId")&&"0"!==localStorage.getItem("signItemId")&&(e=localStorage.getItem("signItemId")),localStorage.removeItem("signItemId");let t=[{groupCondition:"",filters:[{criteria:"processId",condition:"IS_EQUALS_TO",value:this.selectedProcess.processId.toString()},{criteria:"repositoryId",condition:"IS_EQUALS_TO",value:this.selectedProcess.itemData.repositoryId.toString()},{criteria:"itemId",condition:"IS_EQUALS_TO",value:e}]}];try{const e=await p()({url:`https://appuat.ezofis.com/ezofisapi/api/annotation/signSettingsList/${this.$store.state.session.tenantId}/${this.selectedProcess.id}`,method:"POST",headers:{Accept:"application/json"},data:t}),{status:s,data:i}=e;if(200!==s)throw"Invalid response";let o=JSON.parse(i),a=JSON.parse(o.settingsJson);if(console.log(a,"signerDet"),a.length){let e=a.find(e=>e.externalSignerId==this.userId);if(e&&e.signOrder){let t=e.signOrder+1,s=a.find(e=>e.signOrder===t);s&&("External"==s.signerType?this.forwardUsers.push(s.externalSignerId):this.forwardUsers.push(s.signerId))}}this.saveAction=this.processActions[0],this.processRequest(!1,!1)}catch(s){console.error(s),this.$alert.error("error getting signer details")}}}},x=$,B=(s("757d"),s("2877")),q=s("58ea"),P=s("2c91"),M=s("b047"),T=s("cb32"),L=s("8169"),E=s("4e73"),O=s("93dc"),D=s.n(O),N=Object(B["a"])(x,i,o,!1,null,"6afff756",null);t["default"]=N.exports;D()(N,"components",{QCircularProgress:q["a"],QSpace:P["a"],QChip:M["a"],QAvatar:T["a"],QChatMessage:L["a"],QMenu:E["a"]})},"0c21":function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"cursor-pointer",attrs:{id:"async-select-field"}},[e.label?t("FormFieldLabel",{attrs:{label:e.label,"is-mandatory":e.isMandatory,tooltip:e.tooltip}}):e._e(),t("FormFieldWrapper",{ref:"wrapper",attrs:{"is-focused":e._isFocused,"is-clearable":e._isClearable,"is-readonly":e.isReadonly,"is-disabled":e.isDisabled,"has-error":!!e.error,"action-icon":"eva-chevron-down"},on:{click:e.showOptionPicker,clear:e.handleClear},scopedSlots:e._u([{key:"default",fn:function(){return[t("div",{staticClass:"async-select"},[e.value?t("div",{staticClass:"value"},[e._v(" "+e._s(e.value)+" ")]):e._e(),t("input",{ref:"searchQuery",staticClass:"q-px-sm",attrs:{type:"text",placeholder:e._placeholder},domProps:{value:e.searchQuery},on:{focus:function(t){e.isFocused=!0},blur:function(t){e.isFocused=!1},input:e.debouncedInput,keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleKeypress.apply(null,arguments)}}})]),t("q-menu",{attrs:{target:e.$refs.wrapper,fit:"","no-focus":"","no-refocus":"","no-parent-event":"","transition-show":"scale","transition-hide":"scale"},model:{value:e.optionPicker,callback:function(t){e.optionPicker=t},expression:"optionPicker"}},[t("OptionPicker",{attrs:{value:e.value,options:e._options,"new-option":e.newOption},on:{select:e.handleSelect,loadMore:e.getOptions}})],1)]},proxy:!0},{key:"action",fn:function(){return[e.isLoading?t("q-spinner",{staticClass:"q-mr-sm",attrs:{color:"secondary",size:"20px"}}):e._e()]},proxy:!0}])}),e.error?t("FormFieldError",{attrs:{error:e.error}}):e._e()],1)},o=[],a=(s("caad"),s("14d9"),s("3445")),r=s("0f01"),n=s("e683"),l=s("29db"),d=s("0d5e"),c=s("9996"),h=s("32e8"),u=s("5c8a"),f=s("85b1"),m={name:"AsyncSelectField",components:{FormFieldLabel:a["a"],FormFieldWrapper:r["a"],FormFieldError:n["a"],OptionPicker:l["a"]},props:{value:{type:[String,Number],default:null},label:{type:String,default:""},placeholder:{type:String,default:""},isMandatory:{type:Boolean,default:!1},tooltip:{type:String,default:""},isDisabled:{type:Boolean,default:!1},isReadonly:{type:Boolean,default:!1},isClearable:{type:Boolean,default:!0},error:{type:String,default:""},newOption:{type:Boolean,default:!1},apiPath:{type:String,default:""},columnName:{type:String,default:""}},data(){return{isFocused:!1,optionPicker:!1,searchQuery:"",options:[],isLoading:!1,optionsClone:[]}},computed:{_placeholder(){return""},_isFocused(){return this.isFocused||this.optionPicker},_isClearable(){return this.isClearable&&!!this.value},_options(){return this.searchQuery?this.optionsClone.filter(e=>Object(c["a"])(e).includes(Object(c["a"])(this.searchQuery))):this.optionsClone}},watch:{options:{immediate:!0,deep:!0,handler(){Object(h["a"])(this.options,this.optionsClone)||(this.optionsClone=Object(u["a"])(this.options))}},optionPicker(){this.optionPicker||(this.searchQuery="")},columnName(){this.columnName&&(this.options=[],this.getOptions())}},created(){this.getOptions()},methods:{showOptionPicker(){this.optionPicker=!0},handleChange(e){this.searchQuery=e.target.value},handleSelect(e){this.$emit("input",e),this.optionPicker=!1},handleKeypress(){this.searchQuery&&this.newOption&&(this.handleSelect(this.searchQuery),this.searchQuery="",this.$refs.searchQuery.blur())},handleClear(){this.$emit("input","")},debouncedInput:Object(f["a"])((function(e){this.searchQuery=e.target.value}),1),async getOptions(){try{const e=await d["b"].post(this.apiPath,JSON.stringify({column:this.label||this.columnName,keyword:this.searchQuery,rowFrom:this.options.length||0,rowCount:this.options.length})),{status:t,data:s}=e;if(200!==t)throw e;const i=JSON.parse(s);this.options.push(...i)}catch(e){console.error(e),this.$alert.error("Error fetching options")}}}},p=m,y=(s("da87"),s("2877")),v=s("4e73"),w=s("0d59"),g=s("93dc"),b=s.n(g),C=Object(y["a"])(p,i,o,!1,null,"f4e0ea94",null);t["a"]=C.exports;b()(C,"components",{QMenu:v["a"],QSpinner:w["a"]})},"0c4b":function(e,t,s){e.exports=s.p+"img/logo-light.7cfed3a8.png"},"1a05":function(e,t,s){"use strict";s("6df8")},"1c1c":function(e,t,s){"use strict";var i=s("a026"),o=s("b7fa"),a=s("87e8"),r=s("e277");t["a"]=i["default"].extend({name:"QList",mixins:[a["a"],o["a"]],props:{bordered:Boolean,dense:Boolean,separator:Boolean,padding:Boolean,tag:{type:String,default:"div"}},computed:{classes(){return"q-list"+(!0===this.bordered?" q-list--bordered":"")+(!0===this.dense?" q-list--dense":"")+(!0===this.separator?" q-list--separator":"")+(!0===this.isDark?" q-list--dark":"")+(!0===this.padding?" q-list--padding":"")}},render(e){return e(this.tag,{class:this.classes,on:{...this.qListeners}},Object(r["c"])(this,"default"))}})},"1c54":function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;return t("q-dialog",{attrs:{value:e.value},on:{input:e.close}},[t("div",{class:e.cssClass,style:{width:e.width},attrs:{id:"confirm"}},[t("div",{staticClass:"header"},[t("BaseIcon",{staticClass:"q-mr-md",attrs:{name:e.icon,color:e.iconColor,size:e.iconSize}}),t("div",{staticClass:"title-1"},[e._t("title")],2),t("q-space"),t("BaseCloseButton",{on:{click:e.close}})],1),e._t("default"),e.hasFooter?t("div",{staticClass:"footer"},[e._t("footer")],2):e._e()],2)])},o=[],a={name:"Confirm",props:{value:{type:Boolean,required:!0},width:{type:String,default:"480px"},icon:{type:String,required:!0},iconColor:{type:String,default:"secondary"},iconSize:{type:String,default:"20px"},hasFooter:{type:Boolean,default:!0},cssClass:{type:String,default:""}},methods:{close(){this.$emit("input",!1)}}},r=a,n=(s("c7a9"),s("2877")),l=s("24e8"),d=s("2c91"),c=s("93dc"),h=s.n(c),u=Object(n["a"])(r,i,o,!1,null,"3a193cc6",null);t["a"]=u.exports;h()(u,"components",{QDialog:l["a"],QSpace:d["a"]})},2573:function(e,t,s){"use strict";s("b963")},2948:function(e,t,s){"use strict";s("f108")},"29db":function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"options-picker"}},[t("BaseScrollbar",{staticClass:"q-py-sm",attrs:{height:"256px"},on:{scroll:e.handleScroll}},[e.options.length?e._l(e.options,(function(s){return t("div",{key:s,staticClass:"option",class:{"is-selected":e.isSelected(s)},on:{click:function(t){return e.handleClick(s)}}},[t("BaseIcon",{staticClass:"icon",attrs:{name:e.icon(s),"inherit-color":""}}),t("div",{staticClass:"label"},[e._v(e._s(s))])],1)})):t("div",{staticClass:"no-option"},[t("div",{staticClass:"q-mb-sm"},[e._v("No option found")]),e.newOption?t("div",[e._v('Press "Enter" to add new option')]):e._e()])],2)],1)},o=[],a=s("85b1"),r={name:"OptionsPicker",props:{value:{type:[String,Number,Array],required:!0},options:{type:Array,required:!0},isMultiple:{type:Boolean,default:!1},newOption:{type:Boolean,default:!1}},methods:{isSelected(e){return this.isMultiple?!!this.value.find(t=>t===e):this.value===e},icon(e){const t=this.isSelected(e);return this.isMultiple?t?"mdi-checkbox-marked":"mdi-checkbox-blank-outline":t?"eva-radio-button-on":"eva-radio-button-off"},handleClick(e){this.$emit("select",e)},handleScroll:Object(a["a"])((function(e){const t=e.target.scrollHeight,s=e.target.scrollTop,i=e.target.clientHeight,o=t-s===i;o&&this.$emit("loadMore")}),300)}},n=r,l=(s("1a05"),s("2877")),d=Object(l["a"])(n,i,o,!1,null,"12738659",null);t["a"]=d.exports},4074:function(e,t,s){"use strict";var i=s("a026"),o=s("87e8"),a=s("e277");t["a"]=i["default"].extend({name:"QItemSection",mixins:[o["a"]],props:{avatar:Boolean,thumbnail:Boolean,side:Boolean,top:Boolean,noWrap:Boolean},computed:{classes(){const e=this.avatar||this.side||this.thumbnail;return{"q-item__section--top":this.top,"q-item__section--avatar":this.avatar,"q-item__section--thumbnail":this.thumbnail,"q-item__section--side":e,"q-item__section--nowrap":this.noWrap,"q-item__section--main":!e,["justify-"+(this.top?"start":"center")]:!0}}},render(e){return e("div",{staticClass:"q-item__section column",class:this.classes,on:{...this.qListeners}},Object(a["c"])(this,"default"))}})},4697:function(e,t,s){"use strict";s("d30f")},"5f3d":function(e,t,s){},"66e5":function(e,t,s){"use strict";s("3c65");var i=s("a026"),o=s("b7fa"),a=s("e2fa"),r=s("8716"),n=s("87e8"),l=s("e277"),d=s("d882"),c=s("dc8a");t["a"]=i["default"].extend({name:"QItem",mixins:[o["a"],r["a"],a["a"],n["a"]],props:{active:{type:Boolean,default:null},clickable:Boolean,dense:Boolean,insetLevel:Number,tabindex:[String,Number],focused:Boolean,manualFocus:Boolean},computed:{isActionable(){return!0===this.clickable||!0===this.hasLink||"label"===this.tag},isClickable(){return!0!==this.disable&&!0===this.isActionable},classes(){return"q-item q-item-type row no-wrap"+(!0===this.dense?" q-item--dense":"")+(!0===this.isDark?" q-item--dark":"")+(!0===this.hasLink&&null===this.active?this.linkClass:!0===this.active?` q-item--active${void 0!==this.activeClass?" "+this.activeClass:""} `:"")+(!0===this.disable?" disabled":"")+(!0===this.isClickable?" q-item--clickable q-link cursor-pointer "+(!0===this.manualFocus?"q-manual-focusable":"q-focusable q-hoverable")+(!0===this.focused?" q-manual-focusable--focused":""):"")},style(){if(void 0!==this.insetLevel){const e=!0===this.$q.lang.rtl?"Right":"Left";return{["padding"+e]:16+56*this.insetLevel+"px"}}},onEvents(){return{...this.qListeners,click:this.__onClick,keyup:this.__onKeyup}}},methods:{__onClick(e){!0===this.isClickable&&(void 0!==this.$refs.blurTarget&&(!0!==e.qKeyEvent&&document.activeElement===this.$el?this.$refs.blurTarget.focus():document.activeElement===this.$refs.blurTarget&&this.$el.focus()),this.__navigateOnClick(e))},__onKeyup(e){if(!0===this.isClickable&&!0===Object(c["a"])(e,13)){Object(d["l"])(e),e.qKeyEvent=!0;const t=new MouseEvent("click",e);t.qKeyEvent=!0,this.$el.dispatchEvent(t)}this.$emit("keyup",e)},__getContent(e){const t=Object(l["d"])(this,"default",[]);return!0===this.isClickable&&t.unshift(e("div",{staticClass:"q-focus-helper",attrs:{tabindex:-1},ref:"blurTarget"})),t}},render(e){const t={class:this.classes,style:this.style,attrs:{role:"listitem"},on:this.onEvents};return!0===this.isClickable?(t.attrs.tabindex=this.tabindex||"0",Object.assign(t.attrs,this.linkAttrs)):!0===this.isActionable&&(t.attrs["aria-disabled"]="true"),e(this.linkTag,t,this.__getContent(e))}})},"6df8":function(e,t,s){},"757d":function(e,t,s){"use strict";s("9c5a")},7794:function(e,t,s){"use strict";s("caad");var i=function(){var e=this,t=e._self._c;return t("div",[t("div",{attrs:{id:"repository-field"}},[e.showFreeze?t("div",{attrs:{id:"checkbox-field"}},[t("BaseIcon",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:"Freeze",expression:"'Freeze'",modifiers:{top:!0}}],staticClass:"q-mr-sm",attrs:{name:e.freezed?"eva-checkmark-circle-2":"eva-radio-button-off-outline",color:"secondary"},on:{click:e.handleFreeze},model:{value:e.freezed,callback:function(t){e.freezed=t},expression:"freezed"}})],1):e._e(),"SHORT_TEXT"===e.field.dataType||"BARCODE"===e.field.dataType?t("ValidationProvider",{staticClass:"full-width",attrs:{name:e.field.name,rules:{required:e.field.isMandatory}},scopedSlots:e._u([{key:"default",fn:function({errors:s}){return[t("TextField",{attrs:{value:e.value,"is-mandatory":e.field.isMandatory,label:e.label||e.field.name,error:s[0],"is-readonly":e.readOnly},on:{input:e.handleInput}})]}}],null,!1,2138129544)}):e._e(),"NUMBER"===e.field.dataType?t("ValidationProvider",{staticClass:"full-width",attrs:{name:e.field.name,rules:{required:e.field.isMandatory,integer:!e.field.options.allowDecimals}},scopedSlots:e._u([{key:"default",fn:function({errors:s}){return[t("NumberField",{attrs:{value:e.value,"is-mandatory":e.field.isMandatory,label:e.label||e.field.name,error:s[0],"is-readonly":e.readOnly},on:{input:e.handleInput}})]}}],null,!1,3272965974)}):e._e(),"DATE"===e.field.dataType?t("ValidationProvider",{staticClass:"full-width",attrs:{name:e.field.name,rules:{required:e.field.isMandatory}},scopedSlots:e._u([{key:"default",fn:function({errors:s}){return[t("DateField",{attrs:{value:e.value,"is-mandatory":e.field.isMandatory,label:e.label||e.field.name,error:s[0],"is-readonly":e.readOnly},on:{input:e.handleInput}})]}}],null,!1,2736912833)}):e._e(),"TIME"===e.field.dataType?t("ValidationProvider",{staticClass:"full-width",attrs:{name:e.field.name,rules:{required:e.field.isMandatory}},scopedSlots:e._u([{key:"default",fn:function({errors:s}){return[t("TimeField",{attrs:{value:e.value,"is-mandatory":e.field.isMandatory,label:e.label||e.field.name,error:s[0],"is-readonly":e.readOnly},on:{input:e.handleInput}})]}}],null,!1,2195704480)}):e._e(),"DATE_TIME"===e.field.dataType?t("ValidationProvider",{staticClass:"full-width",attrs:{name:e.field.name,rules:{required:e.field.isMandatory}},scopedSlots:e._u([{key:"default",fn:function({errors:s}){return[t("DateTimeField",{attrs:{value:e.value,"is-mandatory":e.field.isMandatory,label:e.label||e.field.name,error:s[0],"is-readonly":e.readOnly},on:{input:e.handleInput}})]}}],null,!1,1802324180)}):e._e(),"SINGLE_SELECT"===e.field.dataType&&["EXISTING"].includes(e.field.options.optionsType)?t("ValidationProvider",{staticClass:"full-width",attrs:{name:e.field.name,rules:{required:e.field.isMandatory}},scopedSlots:e._u([{key:"default",fn:function({errors:s}){return[t("AsyncSelectField",{attrs:{value:e.value,"is-mandatory":e.field.isMandatory,label:e.label||e.field.name,"api-path":e.apiPath,error:s[0],"new-option":e.field.options.allowToAddNewOptions,"is-readonly":e.readOnly},on:{input:e.handleInput}})]}}],null,!1,364407705)}):e._e(),"SINGLE_SELECT"===e.field.dataType&&"PREDEFINED"===e.field.options.optionsType?t("ValidationProvider",{staticClass:"full-width",attrs:{name:e.field.name,rules:{required:e.field.isMandatory}},scopedSlots:e._u([{key:"default",fn:function({errors:s}){return[t("SelectField",{attrs:{value:e.value,"is-mandatory":e.field.isMandatory,label:e.label||e.field.name,error:s[0],"new-option":e.field.options.allowToAddNewOptions,options:e.predefinedSelectOptions,"is-readonly":e.readOnly,page:"repository"},on:{input:e.handleInput}})]}}],null,!1,3382750843)}):e._e(),"SINGLE_SELECT"===e.field.dataType&&["MASTER"].includes(e.field.options.optionsType)?t("ValidationProvider",{staticClass:"full-width",attrs:{name:e.field.name,rules:{required:e.field.isMandatory}},scopedSlots:e._u([{key:"default",fn:function({errors:s}){return[t("SelectField",{attrs:{value:e.value,"is-mandatory":e.field.isMandatory,label:e.label||e.field.name,error:s[0],"new-option":e.field.options.allowToAddNewOptions,options:e.options,"is-readonly":e.readOnly,page:"repository"},on:{input:e.handleInput}})]}}],null,!1,768311157)}):e._e(),"BOOLEAN"===e.field.dataType?t("ValidationProvider",{staticClass:"full-width",attrs:{name:e.field.name,rules:{required:e.field.isMandatory}},scopedSlots:e._u([{key:"default",fn:function({errors:s}){return[t("SingleChoiceField",{attrs:{value:e.value,"is-mandatory":e.field.isMandatory,label:e.label||e.field.name,options:e.booleanOptions,error:s[0],"is-readonly":e.readOnly},on:{input:e.handleInput}})]}}],null,!1,61245750)}):e._e(),"OMR"===e.field.dataType?t("ValidationProvider",{staticClass:"full-width",attrs:{name:e.field.name,rules:{required:e.field.isMandatory}},scopedSlots:e._u([{key:"default",fn:function({errors:s}){return[t("SingleChoiceField",{attrs:{value:e.value,"is-mandatory":e.field.isMandatory,label:e.label||e.field.name,options:e.omrOptions,error:s[0],"is-readonly":e.readOnly},on:{input:e.handleInput}})]}}],null,!1,1875132930)}):e._e()],1),t("div",{staticClass:"row items-center justify-center q-mt-sm"},[e.visiableSyncBtn?t("BaseButton",{attrs:{label:"Sync",color:"secondary"},on:{click:function(t){return e.$emit("saveSync",e.field)}}}):e._e()],1)])},o=[],a=s("7bb1"),r=s("b3d1"),n=s("ad54"),l=s("53c1"),d=s("cedb"),c=s("d1e5"),h=s("12b8"),u=s("0c21"),f=s("9234"),m=s("0d5e"),p={name:"RepositoryField",components:{ValidationProvider:a["b"],TextField:r["a"],NumberField:n["a"],DateField:l["a"],TimeField:d["a"],DateTimeField:c["a"],SelectField:h["a"],AsyncSelectField:u["a"],SingleChoiceField:f["a"]},props:{field:{type:Object,required:!0},repositoryId:{type:[String,Number],required:!0},value:{type:[String,Number],required:!0},readOnly:{type:Boolean,default:!1},label:{type:String,default:""},syncField:{type:Object,default:()=>{}},parentControl:{type:Boolean,default:!1},rowIndex:{type:Number,required:!0},filter:{type:Boolean,default:!1},freezedData:{type:Object,default:()=>{}},showFreeze:{type:Boolean,default:!1}},data(){return{booleanOptions:[{id:this.$nano.id(),label:this.field.options.truthyValue,value:this.field.options.truthyValue},{id:this.$nano.id(),label:this.field.options.falsyValue,value:this.field.options.falsyValue}],omrOptions:[{id:this.$nano.id(),label:"Yes",value:"true"},{id:this.$nano.id(),label:"No",value:"false"}],visiableSyncBtn:!1,options:[],freeze:!1,freezeData:this.freezedData,freezed:!1}},computed:{predefinedSelectOptions(){return this.field.options.predefinedOptions.map(e=>({id:this.$nano.id(),label:e,value:e}))},apiPath(){return`/repository/${this.repositoryId}/uniqueColumnValues`}},watch:{field:{immediate:!0,async handler(){for(let e in this.syncField)this.syncField[e]===this.field.name&&(this.visiableSyncBtn=!0)}},filter:{immediate:!0,deep:!0,handler(){this.field.filterBy&&this.field.options.masterFormId&&this.getMasterEntriesFilter(this.field)}}},created(){this.freezedData&&(this.freezed=this.field.name in this.freezedData),this.field.options.masterFormId&&this.getMasterEntries(this.field.options.masterFormId,this.field.options.masterTableColumn)},methods:{handleInput(e){this.$emit("input",e),this.parentControl&&this.$emit("filterBy",this.field,this.rowIndex),this.freezed&&this.updateOrAddField(this.field.name,e)},handleFreeze(){this.freezed=!this.freezed,this.freezed?(this.updateOrAddField(this.field.name,this.value),this.$emit("update:freezed",this.freeze)):this.$emit("update:removeFreezed",this.field.name)},updateOrAddField(e,t){e in this.freezeData?this.freezeData[e]=t:this.freezeData={...this.freezeData,[e]:t},this.$emit("update:freezedData",this.freezeData)},async getMasterEntries(e,t){try{const s=await m["b"].post(`/form/${e}/uniqueColumnValues`,JSON.stringify({column:t,keyword:"",rowFrom:0,rowCount:0})),{status:i,data:o}=s;if(200!==i)throw s;const a=JSON.parse(o);a.length&&(this.options=a.map(e=>({id:this.$nano.id(),label:e,value:e})))}catch(s){console.error(s),this.$alert.error("Error fetching options")}},async getMasterEntriesFilter(e){try{const t=await m["b"].post(`/form/${e.options.masterFormId}/uniqueColumnValues`,JSON.stringify({column:e.options.masterTableColumn,keyword:"",rowFrom:0,rowCount:0,filters:e.filterBy})),{status:s,data:i}=t;if(200!==s)throw t;const o=JSON.parse(i);o.length?(this.options=o.map(e=>({id:this.$nano.id(),label:e,value:e})),1===this.options.length&&this.handleInput(this.options[0].value)):(this.field.options.masterFormId&&this.getMasterEntries(this.field.options.masterFormId,this.field.options.masterTableColumn),this.handleInput(""))}catch(t){console.error(t),this.$alert.error("Error fetching options")}}}},y=p,v=(s("87dc"),s("2877")),w=Object(v["a"])(y,i,o,!1,null,"174d3602",null);t["a"]=w.exports},"7c86":function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return r}));const i=["left","right","up","down","horizontal","vertical"],o={left:!0,right:!0,up:!0,down:!0,horizontal:!0,vertical:!0,all:!0};function a(e){const t={};return i.forEach(s=>{e[s]&&(t[s]=!0)}),0===Object.keys(t).length?o:(!0===t.horizontal&&(t.left=t.right=!0),!0===t.vertical&&(t.up=t.down=!0),!0===t.left&&!0===t.right&&(t.horizontal=!0),!0===t.up&&!0===t.down&&(t.vertical=!0),!0===t.horizontal&&!0===t.vertical&&(t.all=!0),t)}function r(e,t){return void 0===t.event&&void 0!==e.target&&!0!==e.target.draggable&&"function"===typeof t.handler&&"INPUT"!==e.target.nodeName.toUpperCase()&&(void 0===e.qClonedBy||-1===e.qClonedBy.indexOf(t.uid))}},"85b1":function(e,t,s){"use strict";var i=s("2332"),o=s("26ee"),a=function(){return o["a"].Date.now()},r=a,n=/\s/;function l(e){var t=e.length;while(t--&&n.test(e.charAt(t)));return t}var d=l,c=/^\s+/;function h(e){return e?e.slice(0,d(e)+1).replace(c,""):e}var u=h,f=s("1bc6"),m=NaN,p=/^[-+]0x[0-9a-f]+$/i,y=/^0b[01]+$/i,v=/^0o[0-7]+$/i,w=parseInt;function g(e){if("number"==typeof e)return e;if(Object(f["a"])(e))return m;if(Object(i["a"])(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(i["a"])(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=u(e);var s=y.test(e);return s||v.test(e)?w(e.slice(2),s?2:8):p.test(e)?m:+e}var b=g,C="Expected a function",k=Math.max,I=Math.min;function _(e,t,s){var o,a,n,l,d,c,h=0,u=!1,f=!1,m=!0;if("function"!=typeof e)throw new TypeError(C);function p(t){var s=o,i=a;return o=a=void 0,h=t,l=e.apply(i,s),l}function y(e){return h=e,d=setTimeout(g,t),u?p(e):l}function v(e){var s=e-c,i=e-h,o=t-s;return f?I(o,n-i):o}function w(e){var s=e-c,i=e-h;return void 0===c||s>=t||s<0||f&&i>=n}function g(){var e=r();if(w(e))return _(e);d=setTimeout(g,v(e))}function _(e){return d=void 0,m&&o?p(e):(o=a=void 0,l)}function S(){void 0!==d&&clearTimeout(d),h=0,o=c=a=d=void 0}function F(){return void 0===d?l:_(r())}function A(){var e=r(),s=w(e);if(o=arguments,a=this,c=e,s){if(void 0===d)return y(c);if(f)return clearTimeout(d),d=setTimeout(g,t),p(c)}return void 0===d&&(d=setTimeout(g,t)),l}return t=b(t)||0,Object(i["a"])(s)&&(u=!!s.leading,f="maxWait"in s,n=f?k(b(s.maxWait)||0,t):n,m="trailing"in s?!!s.trailing:m),A.cancel=S,A.flush=F,A}t["a"]=_},"87dc":function(e,t,s){"use strict";s("5f3d")},9921:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{style:{width:e.formWidth},attrs:{id:"external-request-history"}},[e.loadingBarContent?t("BaseLoadingBarSheet",{staticClass:"loading-content"}):e._e(),e.historyProcessId?[t("ProcessHistory",{attrs:{"process-id":e.historyProcessId,"selected-process":e.selectedProcess,"external-access":!0},on:{close:function(t){e.historyProcessId=0}}})]:e.loadingBarContent?e._e():[t("div",{staticClass:"header col"},[t("div",{staticClass:"col text-center"},[t("div",{staticClass:"title-1"},[e._v(e._s(e.title))]),t("div",{staticClass:"description"},[e._v(e._s(e.description))])])]),t("StateWrapper",{attrs:{icon:"mdi-history",title:"Process History",description:"History records not found"}})],e._m(0)],2)},o=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"footer"},[t("div",{staticClass:"label"},[e._v("Powered by")]),t("img",{attrs:{src:s("0c4b"),alt:"logo"}})])}],a=s("1b0d"),r=s("c49c"),n=s("8505"),l={name:"ExternalRequestHistory",components:{StateWrapper:r["a"],ProcessHistory:n["a"]},props:{tenantId:{type:String,required:!0},userId:{type:String,required:!0},workflowId:{type:String,required:!0},processId:{type:String,required:!0}},data(){return{loadingBarContent:!0,formWidth:"100%",title:"",description:"",selectedProcess:{},historyProcessId:0}},watch:{userId:{immediate:!0,handler:"getSession"}},methods:{async getSession(){const{error:e}=await a["a"].externalLogin(this.tenantId,this.userId);if(e)return this.loadingBarContent=!1,void this.$alert.info("User Account Not Found");this.getProcess()},async getProcess(){const{error:e,payload:t}=await a["o"].getWorkflowData(this.workflowId,{filterBy:[{filters:[{criteria:"processId",condition:"IS_EQUALS_TO",value:this.processId}]}],itemsPerPage:10,currentPage:1,mode:""});if(e)return this.loadingBarContent=!1,void this.$alert.error(e);this.loadingBarContent=!1,t.meta.totalItems&&t.data.length&&t.data[0].value.length&&(this.selectedProcess=t.data[0].value[0],this.historyProcessId=this.processId,this.title=this.selectedProcess.requestNo)}}},d=l,c=(s("aa27"),s("2877")),h=Object(c["a"])(d,i,o,!1,null,"3d9b013a",null);t["default"]=h.exports},"9c5a":function(e,t,s){},aa27:function(e,t,s){"use strict";s("b6ec")},b2ec:function(e,t,s){},b6ec:function(e,t,s){},b963:function(e,t,s){},c49c:function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"state-wrapper"}},[t("div",{staticClass:"slow-up-down",attrs:{id:"illustration"}},[t("div",{attrs:{id:"shape-1"}}),t("div",{attrs:{id:"shape-2"}}),t("div",{attrs:{id:"shape-3"}},[t("BaseIcon",{staticClass:"icon",attrs:{name:e.icon,size:"80px"}})],1)]),t("div",{staticClass:"title-1"},[e._v(" "+e._s(e.title)+" ")]),t("div",{staticClass:"description"},[e._v(" "+e._s(e.description)+" ")]),e.action?t("BaseButton",{staticClass:"q-mt-lg",attrs:{icon:e.actionIcon,label:e.action},on:{click:function(t){return e.$emit("action")}}}):e._e()],1)},o=[],a={name:"StateWrapper",props:{icon:{type:String,required:!0},title:{type:String,required:!0},description:{type:String,required:!0},action:{type:String,default:""},actionIcon:{type:String,default:""}}},r=a,n=(s("2948"),s("2877")),l=Object(n["a"])(r,i,o,!1,null,"ba5412d8",null);t["a"]=l.exports},c7a9:function(e,t,s){"use strict";s("b2ec")},cade:function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;return e.visible?t("div",e._g({class:{"is-selected":e.isSelected,"is-disabled":!e.subList.length&&"Initiate Workflow"===e.label||e.disabled},style:{padding:e.isSparse?"16px":"8px 16px"},attrs:{id:"list-item"}},e.$listeners),[e.color?[e.icon?t("BaseActionButton",{staticClass:"icon",attrs:{icon:e.icon,color:e.color,size:"14px"}}):e._e()]:[e.icon?t("BaseIcon",{staticClass:"icon",attrs:{name:e.icon,"inherit-color":""}}):e._e()],t("div",{staticClass:"label",style:{color:e.color}},[e._v(e._s(e.label))]),e.subList?[t("q-menu",{attrs:{"transition-show":"scale","transition-hide":"scale",anchor:"top end",self:"top start"}},[t("q-list",e._l(e.subList,(function(s){return t("q-item",{key:s.id,attrs:{clickable:""},on:{click:function(t){return e.$emit("subListAction",s)}}},[t("q-item-section",{attrs:{side:""}},[e.icon?t("BaseIcon",{staticClass:"icon",attrs:{name:e.icon,"inherit-color":""}}):e._e()],1),t("q-item-section",[e._v(e._s(s.name))])],1)})),1)],1)]:e._e()],2):e._e()},o=[],a={name:"ListItem",props:{icon:{type:String,default:""},label:{type:[String,Number],required:!0},isSparse:{type:Boolean,default:!1},isSelected:{type:Boolean,default:!1},color:{type:String,default:""},subList:{type:Array,default:()=>[]},visible:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1}}},r=a,n=(s("2573"),s("2877")),l=s("4e73"),d=s("1c1c"),c=s("66e5"),h=s("4074"),u=s("93dc"),f=s.n(u),m=Object(n["a"])(r,i,o,!1,null,"0b394298",null);t["a"]=m.exports;f()(m,"components",{QMenu:l["a"],QList:d["a"],QItem:c["a"],QItemSection:h["a"]})},d30f:function(e,t,s){},da87:function(e,t,s){"use strict";s("e10a")},e10a:function(e,t,s){},ee54:function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;return t("Modal",{attrs:{value:e.value,"has-footer":"",width:"540px"},on:{input:e.closeModal},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(e._s(e.title))]},proxy:!0},{key:"default",fn:function(){return[t("ValidationObserver",{ref:"form"},[e.editFromFileSheet?e._e():e._l(e._repositoryField,(function(s){return t("div",{key:s.id,staticClass:"field-wrapper"},[[[t("RepositoryField",{staticClass:"col",attrs:{field:s,"repository-id":e.file.repositoryId,"read-only":e.readOnly},model:{value:e.fieldsModel[s.name],callback:function(t){e.$set(e.fieldsModel,s.name,t)},expression:"fieldsModel[field.name]"}})]]],2)})),e.editFromFileSheet?e._l(e.fieldsModalData,(function(s){return t("div",{key:s.id,staticClass:"field-wrapper"},[[[t("RepositoryField",{staticClass:"col",attrs:{field:e.getField(s.fieldId),"repository-id":e.file.repositoryId,"read-only":e.readOnly},model:{value:s.newValue,callback:function(t){e.$set(s,"newValue",t)},expression:"field.newValue"}})]]],2)})):e._e()],2)]},proxy:!0},{key:"footer",fn:function(){return[t("BaseButton",{staticClass:"q-mr-sm",attrs:{"is-flat":"",label:"cancel"},on:{click:e.closeModal}}),t("BaseButton",{attrs:{label:"save"},on:{click:e.save}})]},proxy:!0}])})},o=[],a=(s("14d9"),s("7bb1")),r=s("6a70"),n=s("7794"),l=s("9996"),d=s("7ee8"),c={name:"MetaDataEdit",components:{Modal:r["a"],ValidationObserver:a["a"],RepositoryField:n["a"]},props:{value:{type:Boolean,default:!1},file:{type:Object,required:!0},repositoryField:{type:Array,required:!0},fileData:{type:Array,required:!0},title:{type:String,default:"Metadata Edit"},columns:{type:Array,default:()=>[]},modalValue:{type:Object,default:()=>{}},readOnly:{type:Boolean,default:!1},uploadFilename:{type:String,default:""},editFromFileSheet:{type:Boolean,default:!1},metaDataFields:{type:Object,default:()=>{}}},data(){return{fieldsModel:{},fieldsModalData:[]}},computed:{_repositoryField(){return this.repositoryField.map(e=>({...e,options:e.options?JSON.parse(e.options):[]}))}},watch:{fileData:{immediate:!0,deep:!0,async handler(){this.editFromFileSheet?(this.fieldsModalData=[],this.fileData.length&&this.fileData.forEach(e=>{this.fieldsModalData.push({fieldId:e.id,oldValue:e.value,newValue:e.value})})):this.processFieldsModel()}},value(){this.value&&this.processFieldsModel()}},methods:{processFieldsModel(){if(this.fieldsModel={},this.fileData.length?this.fileData.forEach(e=>{this.$set(this.fieldsModel,e.name,e.value)}):this._repositoryField.forEach(e=>{let t=this.columns.find(t=>Object(l["a"])(t.label)===Object(l["a"])(e.name));t?this.modalValue.formData?this.$set(this.fieldsModel,e.name,this.modalValue.formData.fields[t.id]):this.modalValue[t.name]?this.$set(this.fieldsModel,e.name,this.modalValue[t.name]):this.modalValue[t.id]&&this.$set(this.fieldsModel,e.name,this.modalValue[t.id]):Object(d["a"])(this.metaDataFields)?this.$set(this.fieldsModel,e.name,""):this.$set(this.fieldsModel,e.name,this.metaDataFields[e.name])}),this.uploadFilename){let e=this.uploadFilename.substring(0,this.uploadFilename.lastIndexOf(".")),t=this._repositoryField.find(e=>"filename"==e.name.toLowerCase());t&&this.$set(this.fieldsModel,t.name,e)}},closeModal(){this.$emit("close",!1)},async save(){const e=await this.$refs.form.validate();e&&(this.$emit("save",this.editFromFileSheet?this.fieldsModalData:this.fieldsModel),this.$emit("close",!1))},getField(e){let t=this._repositoryField.find(t=>e===t.id);if(t)return t}}},h=c,u=(s("4697"),s("2877")),f=Object(u["a"])(h,i,o,!1,null,"059cbd7c",null);t["a"]=f.exports},f108:function(e,t,s){},fd26:function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;return t("BaseActionButton",{attrs:{"is-flat":"","no-border":e.noBorder,icon:e.darkTheme?"eva-moon-outline":"eva-sun-outline"},on:{click:e.toggleDarkTheme}})},o=[],a=s("2f62"),r={name:"ThemeSwitcher",props:{noBorder:{type:Boolean,default:!0}},computed:{...Object(a["c"])(["darkTheme"])},methods:{...Object(a["b"])(["toggleDarkTheme"])}},n=r,l=s("2877"),d=Object(l["a"])(n,i,o,!1,null,"b3ced1f0",null);t["a"]=d.exports}}]);
//# sourceMappingURL=external-request.256904a5.js.map