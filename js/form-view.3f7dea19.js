(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["form-view"],{"0c4b":function(t,e,i){t.exports=i.p+"img/logo-light.7cfed3a8.png"},2771:function(t,e,i){"use strict";i("6996")},"5c44":function(t,e,i){},6996:function(t,e,i){},"88e0":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t._self._c;return e("div",[t.loadingBarContent?e("BaseLoadingBarSheet",{staticClass:"loading-content"}):t._e(),e("div",{style:{width:t.formWidth},attrs:{id:"form-view"}},[e("div",{staticClass:"header"},[e("div",{staticClass:"col"},[e("div",{staticClass:"title-1"},[t._v(t._s(t.formName))]),e("div",{staticClass:"description"},[t._v(t._s(t.formDescription))])]),e("BaseActionButton",{attrs:{"is-flat":"",icon:t.isMaximized?"eva-collapse":"eva-expand"},on:{click:t.toggleWidth}}),e("ThemeSwitcher",{staticClass:"q-ml-sm",attrs:{"no-border":!1}})],1),t.form?e("RenderForm",{attrs:{"form-id":t.formId,panels:t.panels,"secondary-panels":t.secondaryPanels,"form-settings":t.formSettings,"form-model":t.formModel,"enable-controls":t._enableControls,height:"calc(100vh - 200px)","external-link":!0,"portal-id":t.portal.id,"external-loading":t.externalLoading},on:{"update:externalLoading":function(e){t.externalLoading=e},"update:external-loading":function(e){t.externalLoading=e},save:t.saveForm,formSaveType:t.formSaveType}}):t._e(),e("QRView",{attrs:{"form-id":t.formId,"form-entry-id":t.formEntryId},on:{input:t.closeQRModal},model:{value:t.isQRView,callback:function(e){t.isQRView=e},expression:"isQRView"}}),t._m(0),e("Modal",{attrs:{width:"30vw",height:"50vh","has-footer":""},on:{input:function(e){return t.closeSubmission()}},scopedSlots:t._u([{key:"title",fn:function(){return[t._v("Thank you!")]},proxy:!0},{key:"default",fn:function(){return[e("BaseIcon",{staticClass:"imgCenter",attrs:{name:"eva-checkmark-circle-2-outline",color:"positive",size:"80px"}}),e("div",{staticClass:"text-center"},[t._v(" Thank you for submitting the form. We appreciate your participation and the information you have provided. ")])]},proxy:!0},{key:"footer",fn:function(){return[e("BaseButton",{attrs:{label:"Close"},on:{click:t.closeSubmission}})]},proxy:!0}]),model:{value:t.submissionModal,callback:function(e){t.submissionModal=e},expression:"submissionModal"}})],1)],1)},s=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"footer"},[e("div",{staticClass:"label"},[t._v("Powered by")]),e("img",{attrs:{src:i("0c4b"),alt:"logo"}})])}],n=(i("14d9"),i("1b0d")),r=i("fd26"),a=i("4bc4"),l=i("ff16"),d=i("6a70"),c={name:"FormView",components:{ThemeSwitcher:r["a"],RenderForm:a["a"],QRView:l["a"],Modal:d["a"]},props:{tenantId:{type:String,required:!0},formId:{type:String,required:!0}},data(){return{loadingBarContent:!0,form:null,formWidth:"720px",formModel:{},isQRView:!1,formEntryId:0,submissionModal:!1,sendInviteBtn:!1,portal:{},savingType:"",formItemId:0,externalLoading:!1}},computed:{isMaximized(){return"100%"===this.formWidth},formName(){return this.form?this.formSettings.general.name:""},formDescription(){return this.form?this.formSettings.general.description:""},panels(){return this.form?this.form.panels:[]},secondaryPanels(){return this.form?this.form.secondaryPanels:[]},formSettings(){return this.form?this.form.settings:{}},_enableControls(){let t=[],e=[];return this.panels.forEach(i=>{if(i.fields.length){let o=i.fields.filter(t=>"SINGLE_SELECT"===t.type||"SINGLE_CHOICE"===t.type||"MULTIPLE_CHOICE"===t.type||"MULTI_SELECT"===t.type);o.length&&o.forEach(i=>{if(i.settings.validation.enableSettings&&i.settings.validation.enableSettings.length){let o=[];i.settings.validation.enableSettings.forEach(t=>{t.controls.length&&(o.push({value:t.value,childControls:t.controls}),t.controls.forEach(t=>{o.indexOf(t)<0&&e.indexOf(t)<0&&e.push(t)}))}),o.length&&t.push({id:i.id,parentControls:o})}})}}),{listControls:e,controls:t}}},watch:{tenantId:{immediate:!0,handler:"getSession"},externalLoading:{immediate:!0,handler(){this.externalLoading?this.loadingBarContent=!0:this.loadingBarContent=!1}}},methods:{toggleWidth(){this.formWidth="100%"===this.formWidth?"720px":"100%"},async getSession(){this.loadingBarContent=!0;const{error:t}=await n["a"].externalLogin(this.tenantId,1);if(t)return this.loadingBarContent=!1,void this.$alert.info("User Account Not Found");this.getForm(),this.getPortals()},async getForm(){const{error:t,payload:e}=await n["g"].getForm(this.formId);if(this.loadingBarContent=!1,t)return this.loadingBarContent=!1,void this.$alert.error(t);this.form=JSON.parse(e.formJson)},async getPortals(){this.portal={},this.sendInviteBtn=!1;const{error:t,payload:e}=await n["m"].getPortalList({mode:this.mode,sortBy:this.sortBy,groupBy:this.groupBy,filterBy:[{filters:[{criteria:"settingsJson",condition:"CONTAINS",value:'"loginType":"MASTER_LOGIN","formId":'+this.formId+","}],groupCondition:""}],itemsPerPage:this.itemsPerPage,currentPage:this.currentPage});if(t)return void this.$alert.error(t);const{data:i,meta:o}=e;if(o.totalItems&&i.length&&i[0].value.length&&(this.portal=i[0].value[0],this.portal.settingsJson)){let t=JSON.parse(this.portal.settingsJson);"MASTER_LOGIN"===t.authentication.loginType&&t.authentication.notification&&(this.sendInviteBtn=!0)}},async saveForm(t){this.loadingBarContent=!0;let e={fields:t},i=0;"ADD"===this.savingType?i=0:"UPDATE"===this.savingType&&(i=this.formItemId);const{data:o,error:s}=await n["g"].saveFormEntry(this.formId,i,e);if(this.loadingBarContent=!1,s){if(s.data){let t=JSON.parse(s.data);console.log(t);let e=JSON.parse(t.output),i=[];e.forEach(t=>{i.push(t.name)}),this.$alert.warning("Already Exists!",i)}this.$alert.error(s)}else if(this.sendInviteBtn&&this.sendInvite(o.output),this.form.settings.general.qrFields){if(this.form.settings.general.qrFields.length){let t=o.output;this.formEntryId=parseInt(t),this.isQRView=!0}}else this.submissionModal=!0},closeQRModal(){this.submissionModal=!0},closeSubmission(){this.submissionModal=!1,window.location.reload()},async sendInvite(t){let e=location.origin,i="";i="https://app.ezofis.com"===e||"https://appuat.ezofis.com"===e||"https://ag-appsvc01.azurewebsites.net"===e||"https://ag-appsvc05.azurewebsites.net"===e||"https://trial.ezofis.com"===e?`${e}/portals/${this.$store.state.session.tenantId}/${this.portal.id}`:`${e}/app/portals/${this.$store.state.session.tenantId}/${this.portal.id}`;let o=JSON.parse(this.portal.settingsJson),s={formId:this.formId,entryIds:[t],fieldName:o.authentication.usernameField,inviteUrl:i};const{error:r}=await n["g"].sendInvite(this.portal.id,s);r?this.$alert.error(r):this.$alert.success("Invite Sent")},formSaveType(t,e){console.log(t,e),this.savingType=t,this.formItemId="ADD"===t?0:e}}},h=c,f=(i("2771"),i("2877")),m=Object(f["a"])(h,o,s,!1,null,"76ea625c",null);e["default"]=m.exports},"9ff4":function(t,e,i){"use strict";i("5c44")},fd26:function(t,e,i){"use strict";var o=function(){var t=this,e=t._self._c;return e("BaseActionButton",{attrs:{"is-flat":"","no-border":t.noBorder,icon:t.darkTheme?"eva-moon-outline":"eva-sun-outline"},on:{click:t.toggleDarkTheme}})},s=[],n=i("2f62"),r={name:"ThemeSwitcher",props:{noBorder:{type:Boolean,default:!0}},computed:{...Object(n["c"])(["darkTheme"])},methods:{...Object(n["b"])(["toggleDarkTheme"])}},a=r,l=i("2877"),d=Object(l["a"])(a,o,s,!1,null,"b3ced1f0",null);e["a"]=d.exports},ff16:function(t,e,i){"use strict";var o=function(){var t=this,e=t._self._c;return e("Modal",{attrs:{value:t.value,width:"30vw",height:"62vh"},on:{input:t.closeModal},scopedSlots:t._u([{key:"title",fn:function(){return[t._v("QR Image")]},proxy:!0},{key:"default",fn:function(){return[e("div",{staticStyle:{height:"40vh"}},[e("img",{staticClass:"imgCenter",attrs:{src:t.getURL}})]),e("div",{staticClass:"float-right"},[e("BaseButton",{attrs:{icon:"eva-printer",label:"print"},on:{click:function(e){return t.printImg()}}})],1)]},proxy:!0}])})},s=[],n=i("6a70"),r={name:"QRView",components:{Modal:n["a"]},props:{value:{type:Boolean,required:!0},formId:{type:String,default:""},formEntryId:{type:Number,default:0}},data(){return{qrData:"",error:""}},computed:{getURL(){return this.$store.state.session?`https://appuat.ezofis.com/ezofisapi/api/form/qrview/${this.$store.state.session.tenantId}/${this.formId}/${this.formEntryId}`:""}},methods:{closeModal(){this.$emit("input",!1)},printImg(){let t=window.open(this.getURL,"_new");t.print()}}},a=r,l=(i("9ff4"),i("2877")),d=Object(l["a"])(a,o,s,!1,null,"2a4b55c0",null);e["a"]=d.exports}}]);
//# sourceMappingURL=form-view.3f7dea19.js.map